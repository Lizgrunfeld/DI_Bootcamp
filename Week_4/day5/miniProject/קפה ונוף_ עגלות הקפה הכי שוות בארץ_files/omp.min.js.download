!function(){var e={769:function(e,t,i){!function(e,t,i){if("object"==typeof i&&"string"!=typeof i.nodeName)t(e,i);else{i={};var s=["1.3.29-iab3282"],n="default";function r(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]=r(e[t]));return Object.freeze(e)}for(var a in s.push(n),t(e,i),i)i.hasOwnProperty(a)&&(null==Object.getOwnPropertyDescriptor(e,a)&&Object.defineProperty(e,a,{value:{}}),s.forEach((function(t){if(null==Object.getOwnPropertyDescriptor(e[a],t)){var s=r(i[a]);Object.defineProperty(e[a],t,{get:function(){return s},enumerable:!0})}})))}}(void 0===i.g?this:i.g,(function(e,t){"use strict";var s,n=n||{};n.scope={},n.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},n.arrayIterator=function(e){return{next:n.arrayIteratorImpl(e)}},n.makeIterator=function(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):n.arrayIterator(e)},n.arrayFromIterator=function(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i},n.arrayFromIterable=function(e){return e instanceof Array?e:n.arrayFromIterator(n.makeIterator(e))},n.ASSUME_ES5=!1,n.ASSUME_NO_NATIVE_MAP=!1,n.ASSUME_NO_NATIVE_SET=!1,n.SIMPLE_FROUND_POLYFILL=!1,n.objectCreate=n.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(e){var t=function(){};return t.prototype=e,new t},n.underscoreProtoCanBeSet=function(){var e={};try{return e.__proto__={a:!0},e.a}catch(e){}return!1},n.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:n.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,n.inherits=function(e,t){if(e.prototype=n.objectCreate(t.prototype),e.prototype.constructor=e,n.setPrototypeOf){var i=n.setPrototypeOf;i(e,t)}else for(i in t)if("prototype"!=i)if(Object.defineProperties){var s=Object.getOwnPropertyDescriptor(t,i);s&&Object.defineProperty(e,i,s)}else e[i]=t[i];e.superClass_=t.prototype},n.defineProperty=n.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){e!=Array.prototype&&e!=Object.prototype&&(e[t]=i.value)},n.getGlobal=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof i.g&&i.g,e];for(var t=0;t<e.length;++t){var s=e[t];if(s&&s.Math==Math)return s}return globalThis},n.global=n.getGlobal(this),n.SYMBOL_PREFIX="jscomp_symbol_",n.initSymbol=function(){n.initSymbol=function(){},n.global.Symbol||(n.global.Symbol=n.Symbol)},n.SymbolClass=function(e,t){this.$jscomp$symbol$id_=e,n.defineProperty(this,"description",{configurable:!0,writable:!0,value:t})},n.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_},n.Symbol=(s=0,function e(t){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new n.SymbolClass(n.SYMBOL_PREFIX+(t||"")+"_"+s++,t)}),n.initSymbolIterator=function(){n.initSymbol();var e=n.global.Symbol.iterator;e||(e=n.global.Symbol.iterator=n.global.Symbol("Symbol.iterator")),"function"!=typeof Array.prototype[e]&&n.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return n.iteratorPrototype(n.arrayIteratorImpl(this))}}),n.initSymbolIterator=function(){}},n.initSymbolAsyncIterator=function(){n.initSymbol();var e=n.global.Symbol.asyncIterator;e||(e=n.global.Symbol.asyncIterator=n.global.Symbol("Symbol.asyncIterator")),n.initSymbolAsyncIterator=function(){}},n.iteratorPrototype=function(e){return n.initSymbolIterator(),(e={next:e})[n.global.Symbol.iterator]=function(){return this},e},n.iteratorFromArray=function(e,t){n.initSymbolIterator(),e instanceof String&&(e+="");var i=0,s={next:function(){if(i<e.length){var n=i++;return{value:t(n,e[n]),done:!1}}return s.next=function(){return{done:!0,value:void 0}},s.next()}};return s[Symbol.iterator]=function(){return s},s},n.polyfill=function(e,t,i,s){if(t){for(i=n.global,e=e.split("."),s=0;s<e.length-1;s++){var r=e[s];r in i||(i[r]={}),i=i[r]}(t=t(s=i[e=e[e.length-1]]))!=s&&null!=t&&n.defineProperty(i,e,{configurable:!0,writable:!0,value:t})}},n.checkEs6ConformanceViaProxy=function(){try{var e={},t=Object.create(new n.global.Proxy(e,{get:function(i,s,n){return i==e&&"q"==s&&n==t}}));return!0===t.q}catch(e){return!1}},n.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,n.ES6_CONFORMANCE=n.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&n.checkEs6ConformanceViaProxy(),n.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.polyfill("WeakMap",(function(e){function t(){}function i(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function s(e){if(!n.owns(e,a)){var i=new t;n.defineProperty(e,a,{value:i})}}function r(e){var i=Object[e];i&&(Object[e]=function(e){return e instanceof t?e:(s(e),i(e))})}if(n.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&n.ES6_CONFORMANCE)return e}else if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),i=Object.seal({}),s=new e([[t,2],[i,3]]);return 2==s.get(t)&&3==s.get(i)&&(s.delete(t),s.set(i,4),!s.has(t)&&4==s.get(i))}catch(e){return!1}}())return e;var a="$jscomp_hidden_"+Math.random();r("freeze"),r("preventExtensions"),r("seal");var o=0,l=function(e){if(this.id_=(o+=Math.random()+1).toString(),e){e=n.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};return l.prototype.set=function(e,t){if(!i(e))throw Error("Invalid WeakMap key");if(s(e),!n.owns(e,a))throw Error("WeakMap key fail: "+e);return e[a][this.id_]=t,this},l.prototype.get=function(e){return i(e)&&n.owns(e,a)?e[a][this.id_]:void 0},l.prototype.has=function(e){return i(e)&&n.owns(e,a)&&n.owns(e[a],this.id_)},l.prototype.delete=function(e){return!!(i(e)&&n.owns(e,a)&&n.owns(e[a],this.id_))&&delete e[a][this.id_]},l}),"es6","es3"),n.MapEntry=function(){},n.polyfill("Map",(function(e){if(n.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&n.ES6_CONFORMANCE)return e}else if(function(){if(n.ASSUME_NO_NATIVE_MAP||!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),i=new e(n.makeIterator([[t,"s"]]));if("s"!=i.get(t)||1!=i.size||i.get({x:4})||i.set({x:4},"t")!=i||2!=i.size)return!1;var s=i.entries(),r=s.next();return!r.done&&r.value[0]==t&&"s"==r.value[1]&&!((r=s.next()).done||4!=r.value[0].x||"t"!=r.value[1]||!s.next().done)}catch(e){return!1}}())return e;n.initSymbolIterator();var t=new WeakMap,i=function(e){if(this.data_={},this.head_=a(),this.size=0,e){e=n.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};i.prototype.set=function(e,t){var i=s(this,e=0===e?0:e);return i.list||(i.list=this.data_[i.id]=[]),i.entry?i.entry.value=t:(i.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:e,value:t},i.list.push(i.entry),this.head_.previous.next=i.entry,this.head_.previous=i.entry,this.size++),this},i.prototype.delete=function(e){return!(!(e=s(this,e)).entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.data_[e.id],e.entry.previous.next=e.entry.next,e.entry.next.previous=e.entry.previous,e.entry.head=null,this.size--,!0)},i.prototype.clear=function(){this.data_={},this.head_=this.head_.previous=a(),this.size=0},i.prototype.has=function(e){return!!s(this,e).entry},i.prototype.get=function(e){return(e=s(this,e).entry)&&e.value},i.prototype.entries=function(){return r(this,(function(e){return[e.key,e.value]}))},i.prototype.keys=function(){return r(this,(function(e){return e.key}))},i.prototype.values=function(){return r(this,(function(e){return e.value}))},i.prototype.forEach=function(e,t){for(var i,s=this.entries();!(i=s.next()).done;)i=i.value,e.call(t,i[1],i[0],this)},i.prototype[Symbol.iterator]=i.prototype.entries;var s=function(e,i){var s=i&&typeof i;"object"==s||"function"==s?t.has(i)?s=t.get(i):(s=""+ ++o,t.set(i,s)):s="p_"+i;var r=e.data_[s];if(r&&n.owns(e.data_,s))for(e=0;e<r.length;e++){var a=r[e];if(i!=i&&a.key!=a.key||i===a.key)return{id:s,list:r,index:e,entry:a}}return{id:s,list:r,index:-1,entry:void 0}},r=function(e,t){var i=e.head_;return n.iteratorPrototype((function(){if(i){for(;i.head!=e.head_;)i=i.previous;for(;i.next!=i.head;)return i=i.next,{done:!1,value:t(i)};i=null}return{done:!0,value:void 0}}))},a=function(){var e={};return e.previous=e.next=e.head=e},o=0;return i}),"es6","es3");var r={AdEventType:{IMPRESSION:"impression",LOADED:"loaded",GEOMETRY_CHANGE:"geometryChange",SESSION_START:"sessionStart",SESSION_ERROR:"sessionError",SESSION_FINISH:"sessionFinish",MEDIA:"media",VIDEO:"video",START:"start",FIRST_QUARTILE:"firstQuartile",MIDPOINT:"midpoint",THIRD_QUARTILE:"thirdQuartile",COMPLETE:"complete",PAUSE:"pause",RESUME:"resume",BUFFER_START:"bufferStart",BUFFER_FINISH:"bufferFinish",SKIPPED:"skipped",VOLUME_CHANGE:"volumeChange",PLAYER_STATE_CHANGE:"playerStateChange",AD_USER_INTERACTION:"adUserInteraction",STATE_CHANGE:"stateChange"},MediaEventType:{LOADED:"loaded",START:"start",FIRST_QUARTILE:"firstQuartile",MIDPOINT:"midpoint",THIRD_QUARTILE:"thirdQuartile",COMPLETE:"complete",PAUSE:"pause",RESUME:"resume",BUFFER_START:"bufferStart",BUFFER_FINISH:"bufferFinish",SKIPPED:"skipped",VOLUME_CHANGE:"volumeChange",PLAYER_STATE_CHANGE:"playerStateChange",AD_USER_INTERACTION:"adUserInteraction"},ImpressionType:{DEFINED_BY_JAVASCRIPT:"definedByJavaScript",UNSPECIFIED:"unspecified",LOADED:"loaded",BEGIN_TO_RENDER:"beginToRender",ONE_PIXEL:"onePixel",VIEWABLE:"viewable",AUDIBLE:"audible",OTHER:"other"},ErrorType:{GENERIC:"generic",VIDEO:"video",MEDIA:"media"},AdSessionType:{NATIVE:"native",HTML:"html",JAVASCRIPT:"javascript"},EventOwner:{NATIVE:"native",JAVASCRIPT:"javascript",NONE:"none"},AccessMode:{FULL:"full",DOMAIN:"domain",LIMITED:"limited"},AppState:{BACKGROUNDED:"backgrounded",FOREGROUNDED:"foregrounded"},Environment:{APP:"app",WEB:"web"},InteractionType:{CLICK:"click",INVITATION_ACCEPT:"invitationAccept"},CreativeType:{DEFINED_BY_JAVASCRIPT:"definedByJavaScript",HTML_DISPLAY:"htmlDisplay",NATIVE_DISPLAY:"nativeDisplay",VIDEO:"video",AUDIO:"audio"},MediaType:{DISPLAY:"display",VIDEO:"video"},Reason:{NOT_FOUND:"notFound",HIDDEN:"hidden",BACKGROUNDED:"backgrounded",VIEWPORT:"viewport",OBSTRUCTED:"obstructed",CLIPPED:"clipped",UNMEASURABLE:"unmeasurable",NO_WINDOW_FOCUS:"noWindowFocus"},SupportedFeatures:{CONTAINER:"clid",VIDEO:"vlid"},VideoPosition:{PREROLL:"preroll",MIDROLL:"midroll",POSTROLL:"postroll",STANDALONE:"standalone"},VideoPlayerState:{MINIMIZED:"minimized",COLLAPSED:"collapsed",NORMAL:"normal",EXPANDED:"expanded",FULLSCREEN:"fullscreen"},NativeViewKeys:{X:"x",LEFT:"left",Y:"y",TOP:"top",WIDTH:"width",HEIGHT:"height",AD_SESSION_ID:"adSessionId",IS_FRIENDLY_OBSTRUCTION_FOR:"isFriendlyObstructionFor",CLIPS_TO_BOUNDS:"clipsToBounds",CHILD_VIEWS:"childViews",END_X:"endX",END_Y:"endY",OBSTRUCTIONS:"obstructions",OBSTRUCTION_CLASS:"obstructionClass",OBSTRUCTION_PURPOSE:"obstructionPurpose",OBSTRUCTION_REASON:"obstructionReason",PIXELS:"pixels",HAS_WINDOW_FOCUS:"hasWindowFocus"},MeasurementStateChangeSource:{CONTAINER:"container",CREATIVE:"creative"},ElementMarkup:{OMID_ELEMENT_CLASS_NAME:"omid-element"},CommunicationType:{NONE:"NONE",DIRECT:"DIRECT",POST_MESSAGE:"POST_MESSAGE"},OmidImplementer:{OMSDK:"omsdk"}},a=function(e,t,i,s){this.guid=e,this.method=t,this.version=i,this.args=s};a.isValidSerializedMessage=function(e){return!!e&&void 0!==e.omid_message_guid&&void 0!==e.omid_message_method&&void 0!==e.omid_message_version&&"string"==typeof e.omid_message_guid&&"string"==typeof e.omid_message_method&&"string"==typeof e.omid_message_version&&(void 0===e.omid_message_args||void 0!==e.omid_message_args)},a.deserialize=function(e){return new a(e.omid_message_guid,e.omid_message_method,e.omid_message_version,e.omid_message_args)},a.prototype.serialize=function(){var e={};return e.omid_message_guid=this.guid,e.omid_message_method=this.method,e.omid_message_version=this.version,e=e,void 0!==this.args&&(e.omid_message_args=this.args),e};var o=function(e){this.to=e,this.communicationType_=r.CommunicationType.NONE};o.prototype.sendMessage=function(e,t){},o.prototype.handleMessage=function(e,t){this.onMessage&&this.onMessage(e,t)},o.prototype.serialize=function(e){return JSON.stringify(e)},o.prototype.deserialize=function(e){return JSON.parse(e)},o.prototype.isDirectCommunication=function(){return this.communicationType_===r.CommunicationType.DIRECT},o.prototype.isCrossOrigin=function(){};var l={};function d(e,t){if(!t)throw Error("Value for "+e+" is undefined, null or blank.");if("string"!=typeof t&&!(t instanceof String))throw Error("Value for "+e+" is not a string.");if(""===t.trim())throw Error("Value for "+e+" is empty string.")}function c(e,t){if(null==t)throw Error("Value for "+e+" is undefined or null")}function h(e,t){if(null==t)throw Error(e+" must not be null or undefined.");if("number"!=typeof t||isNaN(t))throw Error("Value for "+e+" is not a number")}function u(e,t,i,s){if(h(e,t),t<i||t>s)throw Error("Value for "+e+" is outside the range ["+i+","+s+"]")}l.assertTruthyString=d,l.assertNotNullObject=c,l.assertNumber=h,l.assertNumberBetween=u,l.assertFunction=function(e,t){if(!t)throw Error(e+" must not be truthy.")},l.assertPositiveNumber=function(e,t){if(h(e,t),0>t)throw Error(e+" must be a positive number.")};function m(e,t){return e&&(e[t]||(e[t]={}))}function p(e,i,s){(s=void 0===s?void 0===t?null:t:s)&&((e=e.split(".")).slice(0,e.length-1).reduce(m,s)[e[e.length-1]]=i)}p("OmidSessionClient.Partner",(function(e,t){d("Partner.name",e),d("Partner.version",t),this.name=e,this.version=t}));var v=function(e,t,i,s){s=void 0===s?r.AccessMode.FULL:s,d("VerificationScriptResource.resourceUrl",e),this.resourceUrl=e,this.vendorKey=t,this.verificationParameters=i,this.accessMode=s};v.prototype.toJSON=function(){return{accessMode:this.accessMode,resourceUrl:this.resourceUrl,vendorKey:this.vendorKey,verificationParameters:this.verificationParameters}},p("OmidSessionClient.VerificationScriptResource",v);var g=function(e,t,i,s){i=void 0===i?null:i,s=void 0===s?null:s,c("Context.partner",e),this.partner=e,this.verificationScriptResources=t,this.videoElement=this.slotElement=null,this.contentUrl=i,this.customReferenceData=s,this.underEvaluation=!1,this.serviceWindow=null};g.prototype.setVideoElement=function(e){c("Context.videoElement",e),this.videoElement=e},g.prototype.setSlotElement=function(e){c("Context.slotElement",e),this.slotElement=e},g.prototype.setServiceWindow=function(e){c("Context.serviceWindow",e),this.serviceWindow=e},p("OmidSessionClient.Context",g);var f={};f.omidGlobal=function(){if(void 0!==e&&e)return e;if(void 0!==i.g&&i.g)return i.g;if("undefined"!=typeof window&&window)return window;if("undefined"!=typeof globalThis&&globalThis)return globalThis;var t=Function("return this")();if(t)return t;throw Error("Could not determine global object context.")}();var y="omidSessionInterface",b="adEvents",E="mediaEvents",T={sessionError:"reportError"},w=Object.keys(r.MediaEventType).map((function(e){return r.MediaEventType[e]})),I=["impressionOccurred"],C=function(e){e=void 0===e?f.omidGlobal:e,this.interfaceRoot_=e[y]};C.prototype.isSupported=function(){return null!=this.interfaceRoot_},C.prototype.sendMessage=function(e,t,i){if("registerSessionObserver"==e&&(i=[t]),T[e]&&(e=T[e]),t=this.interfaceRoot_,0<=I.indexOf(e)&&(t=t[b]),0<=w.indexOf(e)&&(t=t[E]),!(t=t[e]))throw Error("Unrecognized method name: "+e+".");t.apply(null,n.arrayFromIterable(i))};var k={};function A(e){for(var t=[],i=0;i<arguments.length;++i)t[i-0]=arguments[i];_((function(){throw new(Function.prototype.bind.apply(Error,[null,"Could not complete the test successfully - "].concat(n.arrayFromIterable(t))))}),(function(){return console.error.apply(console,n.arrayFromIterable(t))}))}function _(e,t){"undefined"!=typeof jasmine&&jasmine?e():"undefined"!=typeof console&&console&&console.error&&t()}k.error=A,k.debug=function(e){for(var t=[],i=0;i<arguments.length;++i)t[i-0]=arguments[i];_((function(){}),(function(){return console.error.apply(console,n.arrayFromIterable(t))}))};var S={};function N(e){return/\d+\.\d+\.\d+(-.*)?/.test(e)}function L(e,t){e=e.split("-")[0].split("."),t=t.split("-")[0].split(".");for(var i=0;i<3;i++){var s=parseInt(e[i],10),n=parseInt(t[i],10);if(s>n)break;if(s<n)return!1}return!0}S.isValidVersion=N,S.versionGreaterOrEqual=L;var M={},R="1.0.3";function x(e,t){return N(e)&&L(e,R)?t:JSON.stringify(t)}function V(e,t){return N(e)&&L(e,R)?t||[]:t&&"string"==typeof t?JSON.parse(t):[]}M.serializeMessageArgs=x,M.deserializeMessageArgs=V;function D(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return e="y"===e?(3&t|8).toString(16):t.toString(16)}))}var U={};function O(e){return null!=e&&void 0!==e.top&&null!=e.top}function P(e){if(e===f.omidGlobal)return!1;try{if(void 0===e.location.hostname)return!0;!function(e){""===e.x||e.x}(e)}catch(e){return!0}return!1}function B(e){return void 0===e&&"undefined"!=typeof window&&window&&(e=window),O(e)?e:f.omidGlobal}function F(e){return O(e)?e.top:f.omidGlobal}U.evaluatePageUrl=function(e){if(!O(e))return null;try{var t=e.top;return P(t)?null:t.location.href}catch(e){return null}},U.isCrossOrigin=P,U.resolveGlobalContext=B,U.resolveTopWindowContext=F,U.isTopWindowAccessible=function(e){try{return!!e.top.location.href}catch(e){return!1}};var H=function(e){o.call(this,e),this.communicationType_=r.CommunicationType.DIRECT,this.handleExportedMessage=H.prototype.handleExportedMessage.bind(this)};n.inherits(H,o),H.prototype.sendMessage=function(e,t){if(!(t=void 0===t?this.to:t))throw Error("Message destination must be defined at construction time or when sending the message.");t.handleExportedMessage(e.serialize(),this)},H.prototype.handleExportedMessage=function(e,t){a.isValidSerializedMessage(e)&&this.handleMessage(a.deserialize(e),t)},H.prototype.isCrossOrigin=function(){return!1};var W=function(e,t){t=void 0===t?f.omidGlobal:t,o.call(this,t);var i=this;this.communicationType_=r.CommunicationType.POST_MESSAGE,e.addEventListener("message",(function(e){if("object"==typeof e.data){var t=e.data;a.isValidSerializedMessage(t)&&(t=a.deserialize(t),e.source&&i.handleMessage(t,e.source))}}))};n.inherits(W,o),W.isCompatibleContext=function(e){return!!(e&&e.addEventListener&&e.postMessage)},W.prototype.sendMessage=function(e,t){if(!(t=void 0===t?this.to:t))throw Error("Message destination must be defined at construction time or when sending the message.");t.postMessage(e.serialize(),"*")},W.prototype.isCrossOrigin=function(){return!this.to||P(this.to)};var j={OMID_PRESENT_FRAME_NAME:"omid_v1_present",isOmidPresent:function(e){try{return!!e.frames&&!!e.frames[j.OMID_PRESENT_FRAME_NAME]}catch(e){return!1}},declareOmidPresence:function(e){e.frames&&e.document&&(j.OMID_PRESENT_FRAME_NAME in e.frames||(null==e.document.body&&j.isMutationObserverAvailable_(e)?j.registerMutationObserver_(e):e.document.body?j.appendPresenceIframe_(e):e.document.write('<iframe style="display:none" id="'+j.OMID_PRESENT_FRAME_NAME+'" name="'+j.OMID_PRESENT_FRAME_NAME+'"></iframe>')))},appendPresenceIframe_:function(e){var t=e.document.createElement("iframe");t.id=j.OMID_PRESENT_FRAME_NAME,t.name=j.OMID_PRESENT_FRAME_NAME,t.style.display="none",e.document.body.appendChild(t)},isMutationObserverAvailable_:function(e){return"MutationObserver"in e},registerMutationObserver_:function(e){var t=new MutationObserver((function(i){i.forEach((function(i){"BODY"===i.addedNodes[0].nodeName&&(j.appendPresenceIframe_(e),t.disconnect())}))}));t.observe(e.document.documentElement,{childList:!0})}},z={},q=["omid","v1_SessionServiceCommunication"],X=["omid","v1_VerificationServiceCommunication"],G=["omidVerificationProperties","serviceWindow"];function Y(e,t){return t.reduce((function(e,t){return e&&e[t]}),e)}function Q(e,t,i,s){if(!P(t))try{var n=Y(t,i);if(n)return new H(n)}catch(e){}return s(t)?new W(e,t):null}function J(e,t,i,s){for(var r=(t=n.makeIterator(t)).next();!r.done;r=t.next())if(r=Q(e,r.value,i,s))return r;return null}function $(e,t,i){i=void 0===i?j.isOmidPresent:i;var s=[e,F(e)];return t&&s.unshift(t),J(e,s,q,i)}z.startSessionServiceCommunication=$,z.startVerificationServiceCommunication=function(e,t){t=void 0===t?j.isOmidPresent:t;var i=[],s=Y(e,G);return s&&i.push(s),i.push(F(e)),J(e,i,X,t)};var K="1.3.29-iab3282",Z=function(e,t,i){c("AdSession.context",e),this.context_=e,this.impressionOccurred_=!1;var s=this.context_.serviceWindow||void 0;this.communication_=t||$(B(),s),this.sessionInterface_=i||new C,this.isSessionRunning_=this.hasMediaEvents_=this.hasAdEvents_=!1,this.impressionType_=this.creativeType_=null,this.creativeLoaded_=!1,this.callbackMap_={},this.communication_&&(this.communication_.onMessage=this.handleInternalMessage_.bind(this)),this.setClientInfo_(),this.injectVerificationScripts_(e.verificationScriptResources),this.sendSlotElement_(e.slotElement),this.sendVideoElement_(e.videoElement),this.sendContentUrl_(e.contentUrl),this.watchSessionEvents_()};Z.prototype.setCreativeType=function(e){if(e===r.CreativeType.DEFINED_BY_JAVASCRIPT)throw Error("Creative type cannot be redefined with value "+r.CreativeType.DEFINED_BY_JAVASCRIPT);if(this.impressionOccurred_)throw Error("Impression has already occurred");if(this.creativeLoaded_)throw Error("Creative has already loaded");if(this.creativeType_&&this.creativeType_!==r.CreativeType.DEFINED_BY_JAVASCRIPT)throw Error("Creative type cannot be redefined");if(void 0===this.creativeType_)throw Error("Native integration is using OMID 1.2 or earlier");this.sendOneWayMessage("setCreativeType",e),this.creativeType_=e},Z.prototype.setImpressionType=function(e){if(e===r.ImpressionType.DEFINED_BY_JAVASCRIPT)throw Error("Impression type cannot be redefined with value "+r.ImpressionType.DEFINED_BY_JAVASCRIPT);if(this.impressionOccurred_)throw Error("Impression has already occurred");if(this.creativeLoaded_)throw Error("Creative has already loaded");if(this.impressionType_&&this.impressionType_!==r.ImpressionType.DEFINED_BY_JAVASCRIPT)throw Error("Impression type cannot be redefined");if(void 0===this.impressionType_)throw Error("Native integration is using OMID 1.2 or earlier");this.sendOneWayMessage("setImpressionType",e),this.impressionType_=e},Z.prototype.isSupported=function(){return!!this.communication_||this.sessionInterface_.isSupported()},Z.prototype.isSendingElementsSupported_=function(){return this.communication_?this.communication_.isDirectCommunication():this.sessionInterface_.isSupported()},Z.prototype.registerSessionObserver=function(e){this.sendMessage("registerSessionObserver",e)},Z.prototype.start=function(){this.sendOneWayMessage("startSession",{customReferenceData:this.context_.customReferenceData,underEvaluation:this.context_.underEvaluation})},Z.prototype.finish=function(){this.sendOneWayMessage("finishSession")},Z.prototype.error=function(e,t){this.sendOneWayMessage("sessionError",e,t)},Z.prototype.registerAdEvents=function(){if(this.hasAdEvents_)throw Error("AdEvents already registered.");this.hasAdEvents_=!0,this.sendOneWayMessage("registerAdEvents")},Z.prototype.registerMediaEvents=function(){if(this.hasMediaEvents_)throw Error("MediaEvents already registered.");this.hasMediaEvents_=!0,this.sendOneWayMessage("registerMediaEvents")},Z.prototype.sendOneWayMessage=function(e,t){for(var i=[],s=1;s<arguments.length;++s)i[s-1]=arguments[s];this.sendMessage.apply(this,[e,null].concat(n.arrayFromIterable(i)))},Z.prototype.sendMessage=function(e,t,i){for(var s=[],n=2;n<arguments.length;++n)s[n-2]=arguments[n];this.communication_?this.sendInternalMessage_(e,t,s):this.sessionInterface_.isSupported()&&this.sendInterfaceMessage_(e,t,s)},Z.prototype.sendInternalMessage_=function(e,t,i){var s=D();t&&(this.callbackMap_[s]=t),e=new a(s,"SessionService."+e,K,x(K,i)),this.communication_.sendMessage(e)},Z.prototype.handleInternalMessage_=function(e,t){t=e.method;var i=e.guid;if(e=e.args,"response"===t&&this.callbackMap_[i]){var s=V(K,e);this.callbackMap_[i].apply(this,s)}"error"===t&&window.console&&A(e)},Z.prototype.sendInterfaceMessage_=function(e,t,i){try{this.sessionInterface_.sendMessage(e,t,i)}catch(e){A("Failed to communicate with SessionInterface with error:"),A(e)}},Z.prototype.assertSessionRunning=function(){if(!this.isSessionRunning_)throw Error("Session not started.")},Z.prototype.impressionOccurred=function(){if(this.creativeType_===r.CreativeType.DEFINED_BY_JAVASCRIPT)throw Error("Creative type has not been redefined");if(this.impressionType_===r.ImpressionType.DEFINED_BY_JAVASCRIPT)throw Error("Impression type has not been redefined");this.impressionOccurred_=!0},Z.prototype.creativeLoaded=function(){if(this.creativeType_===r.CreativeType.DEFINED_BY_JAVASCRIPT)throw Error("Creative type has not been redefined");if(this.impressionType_===r.ImpressionType.DEFINED_BY_JAVASCRIPT)throw Error("Impression type has not been redefined");this.creativeLoaded_=!0},Z.prototype.setClientInfo_=function(){this.sendOneWayMessage("setClientInfo",K,this.context_.partner.name,this.context_.partner.version)},Z.prototype.injectVerificationScripts_=function(e){e&&(e=e.map((function(e){return e.toJSON()})),this.sendOneWayMessage("injectVerificationScriptResources",e))},Z.prototype.sendSlotElement_=function(e){this.sendElement_(e,"setSlotElement")},Z.prototype.sendVideoElement_=function(e){this.sendElement_(e,"setVideoElement")},Z.prototype.sendElement_=function(e,t){e&&(this.isSendingElementsSupported_()?this.sendOneWayMessage(t,e):this.error(r.ErrorType.GENERIC,"Session Client "+t+" called when communication is cross-origin"))},Z.prototype.sendContentUrl_=function(e){e&&this.sendOneWayMessage("setContentUrl",e)},Z.prototype.setElementBounds=function(e){c("AdSession.elementBounds",e),this.sendOneWayMessage("setElementBounds",e)},Z.prototype.watchSessionEvents_=function(){var e=this;this.registerSessionObserver((function(t){t.type===r.AdEventType.SESSION_START&&(e.isSessionRunning_=!0,e.creativeType_=t.data.creativeType,e.impressionType_=t.data.impressionType),t.type===r.AdEventType.SESSION_FINISH&&(e.isSessionRunning_=!1)}))},p("OmidSessionClient.AdSession",Z);var ee=function(e,t,i,s){this.isSkippable=e,this.skipOffset=t,this.isAutoPlay=i,this.position=s};ee.prototype.toJSON=function(){return{isSkippable:this.isSkippable,skipOffset:this.skipOffset,isAutoPlay:this.isAutoPlay,position:this.position}};var te=function(e){c("AdEvents.adSession",e);try{e.registerAdEvents(),this.adSession=e}catch(e){throw Error("AdSession already has an ad events instance registered")}};te.prototype.impressionOccurred=function(){this.adSession.assertSessionRunning(),this.adSession.impressionOccurred(),this.adSession.sendOneWayMessage("impressionOccurred")},te.prototype.loaded=function(e){e=void 0===e?null:e,this.adSession.creativeLoaded(),e?this.adSession.sendOneWayMessage("loaded",e.toJSON()):this.adSession.sendOneWayMessage("loaded")},p("OmidSessionClient.AdEvents",te);var ie=function(e){c("MediaEvents.adSession",e);try{e.registerMediaEvents(),this.adSession=e}catch(e){throw Error("AdSession already has a media events instance registered")}};ie.prototype.start=function(e,t){h("MediaEvents.start.duration",e),u("MediaEvents.start.mediaPlayerVolume",t,0,1),this.adSession.sendOneWayMessage("start",e,t)},ie.prototype.firstQuartile=function(){this.adSession.sendOneWayMessage("firstQuartile")},ie.prototype.midpoint=function(){this.adSession.sendOneWayMessage("midpoint")},ie.prototype.thirdQuartile=function(){this.adSession.sendOneWayMessage("thirdQuartile")},ie.prototype.complete=function(){this.adSession.sendOneWayMessage("complete")},ie.prototype.pause=function(){this.adSession.sendOneWayMessage("pause")},ie.prototype.resume=function(){this.adSession.sendOneWayMessage("resume")},ie.prototype.bufferStart=function(){this.adSession.sendOneWayMessage("bufferStart")},ie.prototype.bufferFinish=function(){this.adSession.sendOneWayMessage("bufferFinish")},ie.prototype.skipped=function(){this.adSession.sendOneWayMessage("skipped")},ie.prototype.volumeChange=function(e){u("MediaEvents.volumeChange.mediaPlayerVolume",e,0,1),this.adSession.sendOneWayMessage("volumeChange",e)},ie.prototype.playerStateChange=function(e){c("MediaEvents.playerStateChange.playerState",e),this.adSession.sendOneWayMessage("playerStateChange",e)},ie.prototype.adUserInteraction=function(e){c("MediaEvents.adUserInteraction.interactionType",e),this.adSession.sendOneWayMessage("adUserInteraction",e)},p("OmidSessionClient.MediaEvents",ie);p("OmidSessionClient.OmidVersion",(function(e,t){d("OmidVersion.semanticVersion",e),d("OmidVersion.apiLevel",t)})),p("OmidSessionClient.VastProperties",ee);var se={VerificationVendorId:{OTHER:1,MOAT:2,DOUBLEVERIFY:3,INTEGRAL_AD_SCIENCE:4,PIXELATE:5,NIELSEN:6,COMSCORE:7,MEETRICS:8,GOOGLE:9}};function ne(e){for(var t=n.makeIterator(re.keys()),i=t.next();!i.done;i=t.next()){i=i.value;for(var s=n.makeIterator(re.get(i)),r=s.next();!r.done;r=s.next())if(r.value.test(e))return i}return se.VerificationVendorId.OTHER}var re=new Map([[se.VerificationVendorId.MOAT,[/^(https?:\/\/|\/\/)?[-a-zA-Z0-9.]+\.moatads\.com\/.*$/]],[se.VerificationVendorId.DOUBLEVERIFY,[/^(https?:\/\/|\/\/)?[-a-zA-Z0-9.]+\.doubleverify\.com\/.*$/]],[se.VerificationVendorId.INTEGRAL_AD_SCIENCE,[/^(https?:\/\/|\/\/)?[-a-zA-Z0-9.]+\.adsafeprotected\.com\/.*$/]],[se.VerificationVendorId.PIXELATE,[/^https?:\/\/(q|cdn)\.adrta\.com\/s\/.*\/(aa|aanf)\.js.*$/,/^https:\/\/cdn\.rta247\.com\/s\/.*\/(aa|aanf)\.js.*$/]],[se.VerificationVendorId.NIELSEN,[]],[se.VerificationVendorId.COMSCORE,[/^(https?:\/\/|\/\/)?[-a-zA-Z0-9.]+\.voicefive\.com\/.*$/,/^(https?:\/\/|\/\/)?[-a-zA-Z0-9.]+\.measuread\.com\/.*$/,/^(https?:\/\/|\/\/)?[-a-zA-Z0-9.]+\.scorecardresearch\.com\/.*$/]],[se.VerificationVendorId.MEETRICS,[/^(https?:\/\/|\/\/)?s418\.mxcdn\.net\/bb-serve\/omid-meetrics.*\.js$/]],[se.VerificationVendorId.GOOGLE,[/^(https?:\/\/|\/\/)?pagead2\.googlesyndication\.com\/.*$/,/^(https?:\/\/|\/\/)?www\.googletagservices\.com\/.*$/]]]);p("OmidSessionClient.verificationVendorIdForScriptUrl",ne),p("OmidSessionClient.VerificationVendorId",se.VerificationVendorId),se.verificationVendorIdForScriptUrl=ne;var ae={};function oe(e,t){return Math.abs(e-t)<.01}ae.roughlyLessThan=function(e,t){return t-e>.01},ae.lessThanOrRoughlyEqual=function(e,t){return e<t||oe(e,t)},ae.greaterThanOrRoughlyEqual=function(e,t){return e>t||oe(e,t)}}),t)},150:function(e,t,i){"use strict";var s,n,r,a,o;o=i(874),n=i(206),r=i(440),a=i(290),s=i(325).DOMParser,function(){function e(){}e.get=function(e,t,i){var l,d,c,h,u,m;return c="https:"===(e=o.parse(e)).protocol?a:r,"file:"===e.protocol?n.readFile(e.pathname,"utf8",(function(e,t){var n;return e?i(e):(n=(new s).parseFromString(t),i(null,n))})):(l="",u=function(e){return function(){return e.abort()}},(h=c.get(e.href,(function(e){return e.on("data",(function(e){var i;return l+=e,clearTimeout(i),setTimeout(d,t.timeout||12e4)})),e.on("end",(function(){var e;return clearTimeout(m),e=(new s).parseFromString(l),i(null,e)}))}))).on("error",(function(e){return clearTimeout(m),i(e)})),d=u(h),m=setTimeout(d,t.timeout||12e4))}}()},206:function(){},440:function(){},290:function(){},874:function(){},325:function(){}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,i),r.exports}i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";var e=class{static waterfall(e,t){return e.reduce(((e,i)=>e.then(t?i.bind(t):i)),Promise.resolve())}static getElement(e,t){const i=(e,t)=>{const s=Object.keys(t);let n=null;if(s.indexOf(e)>=0)return t[e];{let r=s.length;for(;r--;)if(t[s[r]]&&"object"==typeof t[s[r]]&&"elm"!==s[r]&&(n=i(e,t[s[r]]),n))return n}return n};return i(e,t)}static humanTime(e){const t=new Date(null);return t.setSeconds(e),t.toISOString().substr(14,5)}};var t,s,n,r,a={prod:{adBlockerDetection:"https://libs.outbrain.com/video/outbrain-media-player/current/ads.min.js",style:"https://libs.outbrain.com/video/outbrain-media-player/current/omp.min.css"},preview:{adBlockerDetection:"https://libs.outbrain.com/video/outbrain-media-player/current/ads.min.js",style:"https://libs.outbrain.com/video/outbrain-media-player/current/omp.min.css"},staging:{adBlockerDetection:"https://libs.outbrain.com/video/outbrain-media-player/staging/ads.min.js",style:"https://libs.outbrain.com/video/outbrain-media-player/staging/omp.min.css"},dev:{adBlockerDetection:"https://localhost:8086/ads.js",style:"https://localhost:8086/omp.css"},omidPartnerName:"outbrain",omidPartnerVersion:"0.0.0"},o=function(){function e(){}return e.xhr=function(){var e;if("withCredentials"in(e=new window.XMLHttpRequest))return e},e.supported=function(){return!!this.xhr()},e.get=function(e,t,i){let s;"https:"===window.location.protocol&&0===e.indexOf("http://")&&i(new Error("XHRURLHandler: Cannot go from HTTPS to HTTP."));try{s=this.xhr(),s.open("GET",e),s.timeout=t.timeout||0,s.withCredentials=t.withCredentials||!1,s.overrideMimeType&&s.overrideMimeType("text/xml"),s.onreadystatechange=function(){4===s.readyState&&(200===s.status?i(null,s.responseXML):i(new Error("XHRURLHandler: "+s.status)))},s.send()}catch(e){i(new Error("XHRURLHandler: Unexpected error"))}},e}(),l=function(){function e(){}return e.xdr=function(){var e;return window.XDomainRequest&&(e=new XDomainRequest),e},e.supported=function(){return!!this.xdr()},e.get=function(e,t,i){var s,n;return(n="function"==typeof window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLDOM"):void 0)?(n.async=!1,(s=this.xdr()).open("GET",e),s.timeout=t.timeout||0,s.withCredentials=t.withCredentials||!1,s.send(),s.onprogress=function(){},s.onload=function(){return n.loadXML(s.responseText),i(null,n)}):i(new Error("FlashURLHandler: Microsoft.XMLDOM format not supported"))},e}(),d=function(){function e(){}return e.get=function(e,t,s){var n,r;return s||("function"==typeof t&&(s=t),t={}),null!=t.response?(r=t.response,delete t.response,s(null,r)):(null!=(n=t.urlhandler)?n.supported():void 0)?t.urlhandler.get(e,t,s):"undefined"==typeof window||null===window?i(150).get(e,t,s):o.supported()?o.get(e,t,s):l.supported()?l.get(e,t,s):s(new Error("Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler"))},e}(),c=function(){this.ads=[],this.errorURLTemplates=[]},h=function(){this.id=null,this.sequence=null,this.system=null,this.title=null,this.description=null,this.advertiser=null,this.pricing=null,this.survey=null,this.errorURLTemplates=[],this.impressionURLTemplates=[],this.viewableImpressionURLTemplates={viewable:[],notViewable:[],viewUndetermined:[]},this.creatives=[],this.extensions=[],this.adVerifications=[]},u=function(){this.attributes={},this.children=[]},m=function(){this.name=null,this.value=null,this.attributes={}},p=function(){function e(){}return e.track=function(e,t){var i,s,n,r,a,o;for(o=[],r=0,a=(s=this.resolveURLTemplates(e,t)).length;r<a;r++)i=s[r],"undefined"!=typeof window&&null!==window&&(n=new Image,o.push(n.src=i));return o},e.resolveURLTemplates=function(e,t){var i,s,n,r,a,o,l,d;for(null==t&&(t={}),i=[],null!=t.ASSETURI&&(t.ASSETURI=this.encodeURIComponentRFC3986(t.ASSETURI)),null!=t.CONTENTPLAYHEAD&&(t.CONTENTPLAYHEAD=this.encodeURIComponentRFC3986(t.CONTENTPLAYHEAD)),null==t.ERRORCODE||/^[0-9]{3}$/.test(t.ERRORCODE)||(t.ERRORCODE=900),t.CACHEBUSTING=this.leftpad(Math.round(1e8*Math.random()).toString()),t.TIMESTAMP=this.encodeURIComponentRFC3986((new Date).toISOString()),t.RANDOM=t.random=t.CACHEBUSTING,s=0,r=e.length;s<r;s++)if(l=e[s]){for(n in t)d=t[n],a="["+n+"]",o="%%"+n+"%%",l=(l=l.replace(a,d)).replace(o,d);i.push(l)}return i},e.encodeURIComponentRFC3986=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16)}))},e.leftpad=function(e){return e.length<8?function(){var t,i,s;for(s=[],t=0,i=8-e.length;0<=i?t<i:t>i;0<=i?t++:t--)s.push("0");return s}().join("")+e:e},e.storage=function(){var e,t;try{t="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){e,t=null}return(null==t||function(e){var t;try{if(t="__VASTUtil__",e.setItem(t,t),e.getItem(t)!==t)return!0}catch(e){return e,!0}return!1}(t))&&(e={},t={length:0,getItem:function(t){return e[t]},setItem:function(t,i){e[t]=i,this.length=Object.keys(e).length},removeItem:function(t){delete e[t],this.length=Object.keys(e).length},clear:function(){e={},this.length=0}}),t}(),e.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},e}(),v=function(e,t){for(var i in t)g.call(t,i)&&(e[i]=t[i]);function s(){this.constructor=e}return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},g={}.hasOwnProperty;n=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.type="linear",this.duration=0,this.skipDelay=null,this.mediaFiles=[],this.videoClickThroughURLTemplate=null,this.videoClickTrackingURLTemplates=[],this.videoCustomClickURLTemplates=[],this.adParameters=null,this.icons=[]}return v(t,e),t}(t=function(e){null==e&&(e={}),this.id=e.id||null,this.adId=e.adId||null,this.sequence=e.sequence||null,this.apiFramework=e.apiFramework||null,this.trackingEvents={}}),r=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.type="nonlinear",this.variations=[]}return v(t,e),t}(t),s=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.type="companion",this.variations=[]}return v(t,e),t}(t);var f=function(){this.id=null,this.fileURL=null,this.deliveryType="progressive",this.mimeType=null,this.codec=null,this.bitrate=0,this.minBitrate=0,this.maxBitrate=0,this.width=0,this.height=0,this.apiFramework=null,this.scalable=null,this.maintainAspectRatio=null},y=function(){this.program=null,this.height=0,this.width=0,this.xPosition=0,this.yPosition=0,this.apiFramework=null,this.offset=null,this.duration=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.iconClickThroughURLTemplate=null,this.iconClickTrackingURLTemplates=[],this.iconViewTrackingURLTemplate=null},b=function(){this.id=null,this.width=0,this.height=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.altText=null,this.companionClickThroughURLTemplate=null,this.companionClickTrackingURLTemplates=[],this.trackingEvents={}},E=function(){this.id=null,this.width=0,this.height=0,this.expandedWidth=0,this.expandedHeight=0,this.scalable=!0,this.maintainAspectRatio=!0,this.minSuggestedDuration=0,this.apiFramework="static",this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.nonlinearClickThroughURLTemplate=null,this.nonlinearClickTrackingURLTemplates=[],this.adParameters=null},T=[].indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(t in this&&this[t]===e)return t;return-1},w=function(){var e;function t(){}return e=[],t.addURLTemplateFilter=function(t){"function"==typeof t&&e.push(t)},t.removeURLTemplateFilter=function(){return e.pop()},t.countURLTemplateFilters=function(){return e.length},t.clearUrlTemplateFilters=function(){return e=[]},t.parse=function(e,t,i){return i||("function"==typeof t&&(i=t),t={}),this._parse(e,null,t,(function(e,t){return i(t,e)}))},t.load=function(e,t,i){return i||("function"==typeof t&&(i=t),t={}),this.parseXmlDocument(null,[],t,e,i)},t._parse=function(t,i,s,n){var r,a,o,l;for(n||("function"==typeof s&&(n=s),s={}),a=0,o=e.length;a<o;a++)r=e[a],t=r(t);return null==i&&(i=[]),i.push(t),d.get(t,s,(l=this,function(e,r){return null!=e?n(e):l.parseXmlDocument(t,i,s,r,n)}))},t.parseXmlDocument=function(e,i,s,n,r){var a,o,l,d,h,u,m,v,g,f,y;if(y=new c,null==(null!=n?n.documentElement:void 0)||"VAST"!==n.documentElement.nodeName)return r(new Error("Invalid VAST XMLDocument"));for(l=0,h=(g=n.documentElement.childNodes).length;l<h;l++)"Error"===(v=g[l]).nodeName&&y.errorURLTemplates.push(t.parseNodeText(v));for(d=0,u=(f=n.documentElement.childNodes).length;d<u;d++)"Ad"===(v=f[d]).nodeName&&(null!=(a=t.parseAdElement(v))?y.ads.push(a):p.track(y.errorURLTemplates,{ERRORCODE:101}));for(o=function(e,t){var i,s,n,o;if(null==e&&(e=null),null==t&&(t=!1),y){for(n=!0,i=0,s=(o=y.ads).length;i<s;i++){if(null!=(a=o[i]).nextWrapperURL)return;a.creatives.length>0&&(n=!1)}return n&&(t||p.track(y.errorURLTemplates,{ERRORCODE:303})),0===y.ads.length&&(y=null),r(e,y)}},m=y.ads.length;m--;)null!=(a=y.ads[m]).nextWrapperURL&&function(n){var r;i.length>(null!==s.wrapperLimit?s.wrapperLimit:9)||(r=n.nextWrapperURL,T.call(i,r)>=0)?(p.track(n.errorURLTemplates,{ERRORCODE:302}),y.ads.splice(y.ads.indexOf(n),1),o(new Error("Wrapper limit reached, as defined by the video player"))):(null!=e&&(n.nextWrapperURL=t.resolveVastAdTagURI(n.nextWrapperURL,e)),t._parse(n.nextWrapperURL,i,s,(function(e,i){var s,r,a,l,d,c;if(s=!1,null!=e)p.track(n.errorURLTemplates,{ERRORCODE:301}),y.ads.splice(y.ads.indexOf(n),1),s=!0;else if(null==i)p.track(n.errorURLTemplates,{ERRORCODE:303}),y.ads.splice(y.ads.indexOf(n),1),s=!0;else for(y.errorURLTemplates=y.errorURLTemplates.concat(i.errorURLTemplates),r=y.ads.indexOf(n),y.ads.splice(r,1),a=0,l=(d=i.ads).length;a<l;a++)c=d[a],t.mergeWrapperAdData(c,n),y.ads.splice(++r,0,c);return delete n.nextWrapperURL,o(e,s)})))}(a);return o()},t.resolveVastAdTagURI=function(e,t){return 0===e.indexOf("//")?""+location.protocol+e:-1===e.indexOf("://")?t.slice(0,t.lastIndexOf("/"))+"/"+e:e},t.mergeWrapperAdData=function(e,t){var i,s,n,r,a,o,l,d,c,h,u,m,p,v,g,f,y,b,E,T,w;for(e.errorURLTemplates=t.errorURLTemplates.concat(e.errorURLTemplates),e.impressionURLTemplates=t.impressionURLTemplates.concat(e.impressionURLTemplates),e.adVerifications=t.adVerifications.concat(e.adVerifications),e.extensions=t.extensions.concat(e.extensions),r=0,d=(m=e.creatives).length;r<d;r++)if(s=m[r],null!=(null!=(p=t.trackingEvents)?p[s.type]:void 0))for(n in v=t.trackingEvents[s.type])w=v[n],(i=s.trackingEvents)[n]||(i[n]=[]),s.trackingEvents[n]=s.trackingEvents[n].concat(w);if(null!=(g=t.videoClickTrackingURLTemplates)?g.length:void 0)for(a=0,c=(f=e.creatives).length;a<c;a++)"linear"===(s=f[a]).type&&(s.videoClickTrackingURLTemplates=s.videoClickTrackingURLTemplates.concat(t.videoClickTrackingURLTemplates));if(null!=(y=t.videoCustomClickURLTemplates)?y.length:void 0)for(o=0,h=(b=e.creatives).length;o<h;o++)"linear"===(s=b[o]).type&&(s.videoCustomClickURLTemplates=s.videoCustomClickURLTemplates.concat(t.videoCustomClickURLTemplates));if(t.viewableImpressionURLTemplates&&(e.viewableImpressionURLTemplates||(e.viewableImpressionURLTemplates={viewable:[],notViewable:[],viewUndetermined:[]}),t.viewableImpressionURLTemplates.viewable&&(e.viewableImpressionURLTemplates.viewable=t.viewableImpressionURLTemplates.viewable.concat(e.viewableImpressionURLTemplates.viewable)),t.viewableImpressionURLTemplates.notViewable&&(e.viewableImpressionURLTemplates.notViewable=t.viewableImpressionURLTemplates.notViewable.concat(e.viewableImpressionURLTemplates.notViewable)),t.viewableImpressionURLTemplates.viewUndetermined&&(e.viewableImpressionURLTemplates.viewUndetermined=t.viewableImpressionURLTemplates.viewUndetermined.concat(e.viewableImpressionURLTemplates.viewUndetermined))),null!=t.videoClickThroughURLTemplate){for(T=[],l=0,u=(E=e.creatives).length;l<u;l++)"linear"===(s=E[l]).type&&null==s.videoClickThroughURLTemplate?T.push(s.videoClickThroughURLTemplate=t.videoClickThroughURLTemplate):T.push(void 0);return T}},t.childByName=function(e,t){var i,s,n,r;for(s=0,n=(r=e.childNodes).length;s<n;s++)if((i=r[s]).nodeName===t)return i},t.childsByName=function(e,t){var i,s,n,r,a;for(s=[],n=0,r=(a=e.childNodes).length;n<r;n++)(i=a[n]).nodeName===t&&s.push(i);return s},t.parseAdElement=function(e){var t,i,s,n,r;for(i=0,s=(n=e.childNodes).length;i<s;i++)if("Wrapper"===(r=(t=n[i]).nodeName)||"InLine"===r){if(this.copyNodeAttribute("id",e,t),this.copyNodeAttribute("sequence",e,t),"Wrapper"===t.nodeName)return this.parseWrapperElement(t);if("InLine"===t.nodeName)return this.parseInLineElement(t)}},t.parseWrapperElement=function(e){var t,i,s,n,r,a,o,l,d,c,h,u,m,p,v,g,f,y,b,E,T,w,I;for(t=this.parseInLineElement(e),null!=(I=this.childByName(e,"VASTAdTagURI"))?t.nextWrapperURL=this.parseNodeText(I):null!=(I=this.childByName(e,"VASTAdTagURL"))&&(t.nextWrapperURL=this.parseNodeText(this.childByName(I,"URL"))),r=0,c=(v=t.creatives).length;r<c;r++)if("linear"===(g=(w=v[r]).type)||"nonlinear"===g){if(null!=w.trackingEvents)for(n in t.trackingEvents||(t.trackingEvents={}),(i=t.trackingEvents)[p=w.type]||(i[p]={}),f=w.trackingEvents)for(T=f[n],(s=t.trackingEvents[w.type])[n]||(s[n]=[]),o=0,h=T.length;o<h;o++)E=T[o],t.trackingEvents[w.type][n].push(E);if(null!=w.videoClickTrackingURLTemplates)for(t.videoClickTrackingURLTemplates||(t.videoClickTrackingURLTemplates=[]),l=0,u=(y=w.videoClickTrackingURLTemplates).length;l<u;l++)a=y[l],t.videoClickTrackingURLTemplates.push(a);if(null!=w.videoClickThroughURLTemplate&&(t.videoClickThroughURLTemplate=w.videoClickThroughURLTemplate),null!=w.videoCustomClickURLTemplates)for(t.videoCustomClickURLTemplates||(t.videoCustomClickURLTemplates=[]),d=0,m=(b=w.videoCustomClickURLTemplates).length;d<m;d++)a=b[d],t.videoCustomClickURLTemplates.push(a)}if(null!=t.nextWrapperURL)return t},t.parseInLineElement=function(e){var i,s,n,r,a,o,l,d,c,u,m,p,v,g,f,y;for((i=new h).id=e.getAttribute("id")||null,i.sequence=e.getAttribute("sequence")||null,l=0,u=(g=e.childNodes).length;l<u;l++)switch((v=g[l]).nodeName){case"Error":i.errorURLTemplates.push(this.parseNodeText(v));break;case"Impression":i.impressionURLTemplates.push(this.parseNodeText(v));break;case"ViewableImpression":(o=t.parseViewableImpressions(v)).viewable&&(i.viewableImpressionURLTemplates.viewable=i.viewableImpressionURLTemplates.viewable.concat(o.viewable)),o.notViewable&&(i.viewableImpressionURLTemplates.notViewable=i.viewableImpressionURLTemplates.notViewable.concat(o.notViewable)),o.viewUndetermined&&(i.viewableImpressionURLTemplates.viewUndetermined=i.viewableImpressionURLTemplates.viewUndetermined.concat(o.viewUndetermined));break;case"AdVerifications":const e=t.parseAdVerifications(v);e.adVerifications&&(i.adVerifications=e.adVerifications.concat(i.adVerifications));break;case"Creatives":for(d=0,m=(f=this.childsByName(v,"Creative")).length;d<m;d++)for(n={id:(r=f[d]).getAttribute("id")||null,adId:this.parseCreativeAdIdAttribute(r),sequence:r.getAttribute("sequence")||null,apiFramework:r.getAttribute("apiFramework")||null},c=0,p=(y=r.childNodes).length;c<p;c++)switch((a=y[c]).nodeName){case"Linear":(s=this.parseCreativeLinearElement(a,n))&&i.creatives.push(s);break;case"NonLinearAds":(s=this.parseNonLinear(a,n))&&i.creatives.push(s);break;case"CompanionAds":(s=this.parseCompanionAd(a,n))&&i.creatives.push(s)}break;case"Extensions":this.parseExtension(i.extensions,this.childsByName(v,"Extension"));break;case"AdSystem":i.system={value:this.parseNodeText(v),version:v.getAttribute("version")||null};break;case"AdTitle":i.title=this.parseNodeText(v);break;case"Description":i.description=this.parseNodeText(v);break;case"Advertiser":i.advertiser=this.parseNodeText(v);break;case"Pricing":i.pricing={value:this.parseNodeText(v),model:v.getAttribute("model")||null,currency:v.getAttribute("currency")||null};break;case"Survey":i.survey=this.parseNodeText(v)}return i},t.parseExtension=function(e,t){var i,s,n,r,a,o,l,d,c,h,p,v,g,f,y,b,E,T,w;for(T=[],l=0,p=t.length;l<p;l++){if(a=t[l],s=new u,a.attributes)for(d=0,v=(y=a.attributes).length;d<v;d++)o=y[d],s.attributes[o.nodeName]=o.nodeValue;for(c=0,g=(b=a.childNodes).length;c<g;c++)if(i=b[c],w=this.parseNodeText(i),"#comment"!==i.nodeName&&""!==w){if((n=new m).name=i.nodeName,n.value=w,i.attributes)for(h=0,f=(E=i.attributes).length;h<f;h++)r=E[h],n.attributes[r.nodeName]=r.nodeValue;s.children.push(n)}T.push(e.push(s))}return T},t.parseCreativeLinearElement=function(e,t){var i,s,r,a,o,l,d,c,h,u,m,p,v,g,b,E,T,w,I,C,k,A,_,S,N,L,M,R,x,V,D,U,O,P,B,F,H,W,j,z,q,X,G,Y,Q,J,$,K,Z,ee,te,ie,se,ne,re,ae,oe,le,de;if((a=new n(t)).duration=this.parseDuration(this.parseNodeText(this.childByName(e,"Duration"))),-1===a.duration&&"Wrapper"!==e.parentNode.parentNode.parentNode.nodeName)return null;if(null==(ne=e.getAttribute("skipoffset"))?a.skipDelay=null:"%"===ne.charAt(ne.length-1)?(W=parseInt(ne,10),a.skipDelay=a.duration*(W/100)):a.skipDelay=this.parseDuration(ne),null!=(de=this.childByName(e,"VideoClicks"))){for(a.videoClickThroughURLTemplate=this.parseNodeText(this.childByName(de,"ClickThrough")),c=0,w=(q=this.childsByName(de,"ClickTracking")).length;c<w;c++)r=q[c],a.videoClickTrackingURLTemplates.push(this.parseNodeText(r));for(b=0,I=(X=this.childsByName(de,"CustomClick")).length;b<I;b++)o=X[b],a.videoCustomClickURLTemplates.push(this.parseNodeText(o))}for(null!=(i=this.childByName(e,"AdParameters"))&&(a.adParameters=this.parseNodeText(i)),E=0,k=(Y=this.childsByName(e,"TrackingEvents")).length;E<k;E++)for(oe=Y[E],T=0,A=(Q=this.childsByName(oe,"Tracking")).length;T<A;T++)if(l=(ae=Q[T]).getAttribute("event"),le=this.parseNodeText(ae),null!=l&&null!=le){if("progress"===l){if(!(F=ae.getAttribute("offset")))continue;l="%"===F.charAt(F.length-1)?"progress-"+F:"progress-"+Math.round(this.parseDuration(F))}null==(s=a.trackingEvents)[l]&&(s[l]=[]),a.trackingEvents[l].push(le)}for(x=0,_=(J=this.childsByName(e,"MediaFiles")).length;x<_;x++)for(O=J[x],P=0,S=($=this.childsByName(O,"MediaFile")).length;P<S;P++)U=$[P],(D=new f).id=U.getAttribute("id"),D.fileURL=this.parseNodeText(U),D.deliveryType=U.getAttribute("delivery"),D.codec=U.getAttribute("codec"),D.mimeType=U.getAttribute("type"),D.apiFramework=U.getAttribute("apiFramework"),D.bitrate=parseInt(U.getAttribute("bitrate")||0),D.minBitrate=parseInt(U.getAttribute("minBitrate")||0),D.maxBitrate=parseInt(U.getAttribute("maxBitrate")||0),D.width=parseInt(U.getAttribute("width")||0),D.height=parseInt(U.getAttribute("height")||0),(se=U.getAttribute("scalable"))&&"string"==typeof se&&("true"===(se=se.toLowerCase())?D.scalable=!0:"false"===se&&(D.scalable=!1)),(V=U.getAttribute("maintainAspectRatio"))&&"string"==typeof V&&("true"===(V=V.toLowerCase())?D.maintainAspectRatio=!0:"false"===V&&(D.maintainAspectRatio=!1)),a.mediaFiles.push(D);if(null!=(v=this.childByName(e,"Icons")))for(B=0,N=(K=this.childsByName(v,"Icon")).length;B<N;B++){for(p=K[B],(h=new y).program=p.getAttribute("program"),h.height=parseInt(p.getAttribute("height")||0),h.width=parseInt(p.getAttribute("width")||0),h.xPosition=this.parseXPosition(p.getAttribute("xPosition")),h.yPosition=this.parseYPosition(p.getAttribute("yPosition")),h.apiFramework=p.getAttribute("apiFramework"),h.offset=this.parseDuration(p.getAttribute("offset")),h.duration=this.parseDuration(p.getAttribute("duration")),H=0,L=(Z=this.childsByName(p,"HTMLResource")).length;H<L;H++)d=Z[H],h.type=d.getAttribute("creativeType")||"text/html",h.htmlResource=this.parseNodeText(d);for(j=0,M=(ee=this.childsByName(p,"IFrameResource")).length;j<M;j++)g=ee[j],h.type=g.getAttribute("creativeType")||0,h.iframeResource=this.parseNodeText(g);for(z=0,R=(te=this.childsByName(p,"StaticResource")).length;z<R;z++)re=te[z],h.type=re.getAttribute("creativeType")||0,h.staticResource=this.parseNodeText(re);if(null!=(m=this.childByName(p,"IconClicks")))for(h.iconClickThroughURLTemplate=this.parseNodeText(this.childByName(m,"IconClickThrough")),ie=0,C=(G=this.childsByName(m,"IconClickTracking")).length;ie<C;ie++)u=G[ie],h.iconClickTrackingURLTemplates.push(this.parseNodeText(u));h.iconViewTrackingURLTemplate=this.parseNodeText(this.childByName(p,"IconViewTracking")),a.icons.push(h)}return a},t.parseNonLinear=function(e,t){var i,s,n,a,o,l,d,c,h,u,m,p,v,g,f,y,b,T,w,I,C,k,A,_,S,N,L,M,R,x,V,D,U,O;for(a=new r(t),d=0,p=(_=this.childsByName(e,"TrackingEvents")).length;d<p;d++)for(U=_[d],h=0,v=(S=this.childsByName(U,"Tracking")).length;h<v;h++)o=(D=S[h]).getAttribute("event"),O=this.parseNodeText(D),null!=o&&null!=O&&(null==(s=a.trackingEvents)[o]&&(s[o]=[]),a.trackingEvents[o].push(O));for(u=0,g=(N=this.childsByName(e,"NonLinear")).length;u<g;u++){for(k=N[u],(C=new E).id=k.getAttribute("id")||null,C.width=k.getAttribute("width"),C.height=k.getAttribute("height"),C.expandedWidth=k.getAttribute("expandedWidth"),C.expandedHeight=k.getAttribute("expandedHeight"),C.scalable=this.parseBoolean(k.getAttribute("scalable")),C.maintainAspectRatio=this.parseBoolean(k.getAttribute("maintainAspectRatio")),C.minSuggestedDuration=this.parseDuration(k.getAttribute("minSuggestedDuration")),C.apiFramework=k.getAttribute("apiFramework"),m=0,f=(L=this.childsByName(k,"HTMLResource")).length;m<f;m++)l=L[m],C.type=l.getAttribute("creativeType")||"text/html",C.htmlResource=this.parseNodeText(l);for(w=0,y=(M=this.childsByName(k,"IFrameResource")).length;w<y;w++)c=M[w],C.type=c.getAttribute("creativeType")||0,C.iframeResource=this.parseNodeText(c);for(I=0,b=(R=this.childsByName(k,"StaticResource")).length;I<b;I++)V=R[I],C.type=V.getAttribute("creativeType")||0,C.staticResource=this.parseNodeText(V);for(null!=(i=this.childByName(k,"AdParameters"))&&(C.adParameters=this.parseNodeText(i)),C.nonlinearClickThroughURLTemplate=this.parseNodeText(this.childByName(k,"NonLinearClickThrough")),A=0,T=(x=this.childsByName(k,"NonLinearClickTracking")).length;A<T;A++)n=x[A],C.nonlinearClickTrackingURLTemplates.push(this.parseNodeText(n));a.variations.push(C)}return a},t.parseCompanionAd=function(e,t){var i,n,r,a,o,l,d,c,h,u,m,p,v,g,f,y,E,T,w,I,C,k,A,_,S,N,L,M,R,x,V,D,U,O,P,B,F;for(l=new s(t),h=0,g=(N=this.childsByName(e,"Companion")).length;h<g;h++){for(o=N[h],(a=new b).id=o.getAttribute("id")||null,a.width=o.getAttribute("width"),a.height=o.getAttribute("height"),a.title=o.getAttribute("title"),a.price=o.getAttribute("price"),a.companionClickTrackingURLTemplates=[],m=0,f=(L=this.childsByName(o,"HTMLResource")).length;m<f;m++)c=L[m],a.type=c.getAttribute("creativeType")||"text/html",a.htmlResource=this.parseNodeText(c);for(p=0,y=(M=this.childsByName(o,"IFrameResource")).length;p<y;p++)u=M[p],a.type=u.getAttribute("creativeType")||0,a.iframeResource=this.parseNodeText(u);for(v=0,E=(R=this.childsByName(o,"StaticResource")).length;v<E;v++){for(O=R[v],a.type=O.getAttribute("creativeType")||0,k=0,T=(x=this.childsByName(o,"AltText")).length;k<T;k++)n=x[k],a.altText=this.parseNodeText(n);a.staticResource=this.parseNodeText(O)}for(A=0,w=(V=this.childsByName(o,"TrackingEvents")).length;A<w;A++)for(B=V[A],_=0,I=(D=this.childsByName(B,"Tracking")).length;_<I;_++)d=(P=D[_]).getAttribute("event"),F=this.parseNodeText(P),null!=d&&null!=F&&(null==(i=a.trackingEvents)[d]&&(i[d]=[]),a.trackingEvents[d].push(F));for(S=0,C=(U=this.childsByName(o,"CompanionClickTracking")).length;S<C;S++)r=U[S],a.companionClickTrackingURLTemplates.push(this.parseNodeText(r));a.companionClickThroughURLTemplate=this.parseNodeText(this.childByName(o,"CompanionClickThrough")),a.companionClickTrackingURLTemplate=this.parseNodeText(this.childByName(o,"CompanionClickTracking")),l.variations.push(a)}return l},t.parseDuration=function(e){var t,i,s,n,r;return null==e?-1:p.isNumeric(e)?parseInt(e):3!==(t=e.split(":")).length?-1:(r=t[2].split("."),n=parseInt(r[0]),2===r.length&&(n+=parseFloat("0."+r[1])),s=parseInt(60*t[1]),i=parseInt(60*t[0]*60),n>60&&(s+=Math.floor(n/60),n%=60),isNaN(i)||isNaN(s)||isNaN(n)||s>3600||n>60?-1:i+s+n)},t.parseXPosition=function(e){return"left"===e||"right"===e||"center"===e?e:parseInt(e||0)},t.parseYPosition=function(e){return"top"===e||"bottom"===e||"middle"===e?e:parseInt(e||0)},t.parseBoolean=function(e){return"true"===e||"TRUE"===e||"1"===e},t.parseNodeText=function(e){return e&&(e.textContent||e.text||"").trim()},t.copyNodeAttribute=function(e,t,i){var s;if(s=t.getAttribute(e))return i.setAttribute(e,s)},t.parseCreativeAdIdAttribute=function(e){return e.getAttribute("AdID")||e.getAttribute("adID")||e.getAttribute("adId")||null},t.parseViewableImpressions=function(e){const t={viewable:[],notViewable:[],viewUndetermined:[]};let i,s,n,r;for(i=e.childNodes,n=0,s=i.length;n<s;n++)switch(r=i[n],r.nodeName){case"Viewable":t.viewable.push(this.parseNodeText(r));break;case"NotViewable":t.notViewable.push(this.parseNodeText(r));break;case"ViewUndetermined":t.viewUndetermined.push(this.parseNodeText(r))}return t},t.parseAdVerifications=function(e){const t={adVerifications:[]};let i,s,n,r,a,o,l,d;for(i=e.childNodes,a=0,n=i.length;a<n;a++)if(l=i[a],"Verification"===l.nodeName){s=l.childNodes;const e={verificationScriptUrl:null,vendorKey:l.getAttribute("vendor"),verificationParameters:null};for(o=0,r=s.length;o<r;o++)switch(d=s[o],d.nodeName){case"JavaScriptResource":e.verificationScriptUrl=this.parseNodeText(d);break;case"VerificationParameters":e.verificationParameters=this.parseNodeText(d)}t.adVerifications.push(e)}return t},t}();var I=class{constructor(e,t,i){this.vastXML=e,this.pixels=t,this.jsTrackers=i,this.vast=null,this.medias=[],this.companionAds=[],this.parseError=["Vast validator - "]}read(){const e=this;return new Promise(((t,i)=>{if(this.vastXML){const s=(new DOMParser).parseFromString(this.vastXML,"text/xml");w.load(s,((s,n)=>{s?i(s):(e.vast=n,t(n))}))}else i(new Error(e.parseError.join("")))}))}setAdsMedias(){const e=this;return new Promise(((t,i)=>{let s=0;const n=e.vast.ads,r=n.length;let a=0;for(;a<r;a++){const t=n[a].creatives?n[a].creatives:e.parseError.push(`No Creatives for ad ${a+1}`);if(!t||0===t.length)continue;s++;const i=t.length;let r,o,l=0,d=[];if(n[a].system&&n[a].system.value?r=n[a].system.value:d.push("AdSystem "),n[a].title?o=n[a].title:d.push("AdTitle "),0===n[a].impressionURLTemplates.length&&d.push("Impression "),d.length>1){let t=[`Missing tags at ad ${a+1}:`];t.push(d.join(",")),e.parseError.push(t.join(""))}for(;l<i;l++){let i;if(t[l].duration?i=t[l].duration:"companion"!==t[l].type&&e.parseError.push(`Duration tag is missing at creative ${s}.`),i||"companion"===t[l].type){if(t[l].mediaFiles){const s=t[l].mediaFiles,o=s.length;let d=0;for(;d<o;d++){let o={duration:i,adParameters:t[l].adParameters,trackingEvents:t[l].trackingEvents,videoClickThroughURLTemplate:t[l].videoClickThroughURLTemplate,videoClickTrackingURLTemplates:t[l].videoClickTrackingURLTemplates,impressions:n[a].impressionURLTemplates.concat(e.pixels),jsTrackers:e.jsTrackers,error:n[a].errorURLTemplates,system:r,viewableImpressions:n[a].viewableImpressionURLTemplates,adVerifications:n[a].adVerifications};e.medias.push(o);for(let t in s[d])s[d].hasOwnProperty(t)&&(e.medias[e.medias.length-1][t]=s[d][t])}}if("companion"===t[l].type){const i=t[l].variations,s=i.length;let n=0;for(;n<s;n++){let t={required:i[n].required,id:i[n].id,width:i[n].width,height:i[n].height,assetWidth:i[n].assetWidth,assetHeight:i[n].assetHeight,expandedWidth:i[n].expandedWidth,expandedHeight:i[n].expandedHeight,apiFramework:i[n].apiFramework,adslotID:i[n].adslotID,pxratio:i[n].pxratio,altText:i[n].altText,type:i[n].type,staticResource:i[n].staticResource,htmlResource:i[n].htmlResource,iframeResource:i[n].iframeResource,companionClickThroughURLTemplate:i[n].companionClickThroughURLTemplate,companionClickTrackingURLTemplates:i[n].companionClickTrackingURLTemplates,trackingEvents:i[n].trackingEvents,title:i[n].title,price:i[n].price};e.companionAds.push(t)}}}}}0===s?(e.parseError.push("No valid creatives found - check duration tag"),i(new Error(e.parseError.join("")))):0===e.medias.length?(e.parseError.push("No valid medias found"),i(new Error(e.parseError.join("")))):e.parseError.length>1?(e.parseError.unshift(new String("Warning - ")),t(new Error(e.parseError.join("")))):t()}))}},C=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","subscribe","unsubscribe"];function k(e,t,i){}k.prototype.handshakeVersion=function(e,t){},k.prototype.initAd=function(e,t,i,s,n,r,a){},k.prototype.startAd=function(e){},k.prototype.stopAd=function(e){},k.prototype.skipAd=function(e){},k.prototype.resizeAd=function(e,t,i,s){},k.prototype.pauseAd=function(e){},k.prototype.resumeAd=function(e){},k.prototype.expandAd=function(e){},k.prototype.collapseAd=function(e){},k.prototype.subscribe=function(e,t,i){},k.prototype.unsubscribe=function(e,t){},k.prototype.getAdLinear=function(e){},k.prototype.getAdWidth=function(e){},k.prototype.getAdHeight=function(e){},k.prototype.getAdExpanded=function(e){},k.prototype.getAdSkippableState=function(e){},k.prototype.getAdRemainingTime=function(e){},k.prototype.getAdDuration=function(e){},k.prototype.getAdVolume=function(e){},k.prototype.getAdCompanions=function(e){},k.prototype.getAdIcons=function(e){},k.prototype.setAdVolume=function(e,t){},S(k,"METHODS",C),S(k,"GETTERS",["getAdLinear","getAdWidth","getAdHeight","getAdExpanded","getAdSkippableState","getAdRemainingTime","getAdDuration","getAdVolume","getAdCompanions","getAdIcons"]),S(k,"SETTERS",["setAdVolume"]),S(k,"EVENTS",["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"]);var A=C.filter((function(e){return-1===["skipAd"].indexOf(e)}));S(k,"checkVPAIDInterface",(function(e){return A.every((function(t){return"function"==typeof e[t]}))}));var _=k;function S(e,t,i){Object.defineProperty(e,t,{writable:!1,configurable:!1,value:i})}function N(){this._subscribers={}}N.prototype.subscribe=function(e,t,i){this.isHandlerAttached(e,t)||this.get(t).push({handler:e,context:i,eventName:t})},N.prototype.unsubscribe=function(e,t){this._subscribers[t]=this.get(t).filter((function(t){return e!==t.handler}))},N.prototype.unsubscribeAll=function(){this._subscribers={}},N.prototype.trigger=function(e,t){var i=this;this.get(e).concat(this.get("*")).forEach((function(e){setTimeout((function(){i.isHandlerAttached(e.handler,e.eventName)&&e.handler.call(e.context,t)}),0)}))},N.prototype.triggerSync=function(e,t){this.get(e).concat(this.get("*")).forEach((function(e){e.handler.call(e.context,t)}))},N.prototype.get=function(e){return this._subscribers[e]||(this._subscribers[e]=[]),this._subscribers[e]},N.prototype.isHandlerAttached=function(e,t){return this.get(t).some((function(t){return e===t.handler}))};var L=N;function M(){}function R(e,t){return e?null:new Error(t)}function x(e,t,i){var s,n,r,a=function(e,t,i){var s=document.createElement("iframe");s.src=t||"about:blank",s.marginWidth="0",s.marginHeight="0",s.frameBorder="0",s.width="100%",s.height="100%",V(s),i&&(s.style.zIndex=i);return s.setAttribute("SCROLLING","NO"),e.innerHTML="",e.appendChild(s),s}(e,null,i.zIndex);if(s=a,n=function(e,t){return Object.keys(t).forEach((function(i){var s="object"==typeof s?JSON.stringify(t[i]):t[i];e=e.replace(new RegExp("{{"+i+"}}","g"),s)})),e}(t,i),(r=s.contentWindow&&s.contentWindow.document)&&(r.write(n),1))return a}function V(e){e&&(e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.margin="0px",e.style.padding="0px",e.style.border="none",e.style.width="100%",e.style.height="100%")}function D(e,t){return Object.keys(t).forEach((function(i){e[i]=t[i]})),e}var U=_.checkVPAIDInterface,O=(_.METHODS,"AdClickThru"),P=_.EVENTS.filter((function(e){return e!=O}));function B(e,t,i,s){this._isValid=U(e),this._isValid&&(this._creative=e,this._el=t,this._videoEl=i,this._iframe=s,this._subscribers=new L,V(t),F.call(this))}function F(){if(P.forEach(function(e){this._creative.subscribe(W.bind(this,e),e)}.bind(this)),this._creative.subscribe(H.bind(this),O),this._videoEl){var e=this._iframe.contentDocument.documentElement,t=this._videoEl;e.addEventListener("click",(function(i){i.target===e&&t.click()}))}}function H(e,t,i){this._subscribers.triggerSync(O,{url:e,id:t,playerHandles:i})}function W(e){let t=arguments.length,i=[];for(;t--;)i[t]=arguments[t];this._subscribers.trigger(e,i.slice(1))}function j(e,t,i,s){e?e(i,s):i&&t.trigger("AdError",i)}B.prototype=Object.create(_.prototype),B.prototype.isValidVPAIDAd=function(){return this._isValid},_.METHODS.forEach((function(e){-1===["subscribe","unsubscribe","initAd"].indexOf(e)&&(B.prototype[e]=function(){var t=_.prototype[e].length,i=Array.prototype.slice.call(arguments),s=t===i.length?i.pop():void 0;setTimeout(function(){var t,n=null;try{t=this._creative[e].apply(this._creative,i)}catch(e){n=e}j(s,this._subscribers,n,t)}.bind(this),0)})})),B.prototype.initAd=function(e,t,i,s,n,r,a){n=n||{},r=D({slot:this._el,videoSlot:this._videoEl},r||{}),setTimeout(function(){var o;try{this._creative.initAd(e,t,i,s,n,r)}catch(e){o=e}j(a,this._subscribers,o)}.bind(this),0)},B.prototype.subscribe=function(e,t,i){this._subscribers.subscribe(t,e,i)},B.prototype.unsubscribe=function(e,t){this._subscribers.unsubscribe(t,e)},B.prototype.on=B.prototype.subscribe,B.prototype.off=B.prototype.unsubscribe,_.GETTERS.forEach((function(e){B.prototype[e]=function(t){setTimeout(function(){var i,s=null;try{i=this._creative[e]()}catch(e){s=e}j(t,this._subscribers,s,i)}.bind(this),0)}})),B.prototype.setAdVolume=function(e,t){setTimeout(function(){var i,s=null;try{this._creative.setAdVolume(e),i=this._creative.getAdVolume()}catch(e){s=e}setTimeout((()=>{s||(s=R(i===e,"failed to apply volume: "+e)),j(t,this._subscribers,s,i)}),200)}.bind(this),0)},B.prototype._destroy=function(){this.stopAd(),this._subscribers.unsubscribeAll()};var z,q,X=B,G=(z="vpaidIframe",q=-1,function(){return z+"_"+ ++q});function Y(e,t,i,s){var n,r,a,o;i=i||{},this._id=G(),this._destroyed=!1,this._frameContainer=(n=e,r="div",o=document.createElement(r),a&&(o.id=a),n.appendChild(o),o),this._videoEl=t,this._vpaidOptions=s||{timeout:1e4},this._templateConfig={template:i.template||'<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"></head><body style="margin:0;padding:0"><div class="ad-element"></div><script type="text/javascript" src="{{iframeURL_JS}}"><\/script><script type="text/javascript">window.parent.postMessage(\'{"event": "ready", "id": "{{iframeID}}"}\', \'{{origin}}\');<\/script></body></html>',extraOptions:i.extraOptions||{}}}function Q(e){var t=this[e];t&&t.parentNode&&(t.parentNode.removeChild(t),delete this[e])}function J(){K.call(this),delete this._adUnit}function $(){K.call(this),ee.call(this)}function K(){Q.call(this,"_frame"),Z.call(this)}function Z(){this._onLoad&&(window.removeEventListener("message",this._onLoad),delete this._onLoad)}function ee(){this._adUnit&&(this._adUnit.stopAd(),delete this._adUnit)}function te(){if(this._destroyed)throw new Error("VPAIDHTML5Client already destroyed!")}function ie(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}Y.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,$.call(this))},Y.prototype.isDestroyed=function(){return this._destroyed},Y.prototype.loadAdUnit=function(e,t){if(!this._onLoad){te.call(this),$.call(this);var i=this,s=x(this._frameContainer,this._templateConfig.template,D({iframeURL_JS:e,iframeID:this.getID(),origin:ie()},this._templateConfig.extraOptions));this._frame=s,this._onLoad=function(e,t,i){var s,n;return n=setTimeout((function(){t=M,i()}),e),s=function(){t.apply(this,arguments)&&clearTimeout(n)},s}(this._vpaidOptions.timeout,function(e){if(e.origin!==ie())return;var s,n,r;if(JSON.parse(e.data).id!==i.getID())return;if(i._frame.contentWindow){if(r=i._frame.contentWindow.getVPAIDAd,n=R("function"==typeof r,"the ad didn't return a function to create an ad"))return}else n="the iframe is not anymore in the DOM tree";if(!n){var a=i._frame.contentWindow.document.querySelector(".ad-element");(s=new X(r(),a,i._videoEl,i._frame)).subscribe("AdStopped",J.bind(i)),n=R(s.isValidVPAIDAd(),"the ad is not fully compliant with VPAID specification")}return i._adUnit=s,Z.call(i),t(n,n?null:s),!0}.bind(this),function(){}.bind(this)),window.addEventListener("message",this._onLoad)}},Y.prototype.unloadAdUnit=function(){$.call(this)},Y.prototype.getID=function(){return this._id};var se=Y;var ne=class{constructor(e,t,i){this.parent=t,this.media=e,this.id=this.parent.id,this.recData=this.parent.options?this.parent.options.adData:void 0,this.companionAds=this.parent.video&&this.parent.video&&this.parent.video.parser&&this.parent.video.parser.companionAds?this.parent.video.parser.companionAds:void 0,this.adUnit=null,this.bridge=null,this.error=null,this.playing=!1,this.started=!1,this.shouldTrackMoat=this.parent.shouldTrackMoat,this.options=this.parent.options,this.moatTracker=null,this.videoStartedPlaying=!1,this.currentVolume=this.parent.options.muted?0:1,this.delayedEvents={resize:{w:null,h:null},mute:!1,unmute:!1,volume:{val:null},seek:{val:null},play:!1,stop:!1,pause:!1,resume:!1},this.subscriptions={ready:[],adstarted:[],adstopped:[],adpaused:[],adresumed:[],adcomplete:[],advolumechanged:[],volume:[],mute:[],unmute:[],seek:[],progress:[],enterfullscreen:[],exitfullscreen:[],fullscreenerror:[],aduseracceptinvitation:[]},this.videoContainer=i,this.initializing=!1,this.currentVolume=t.options.muted?0:1,this.lastPlayedVolume=this.currentVolume,this.style={vpaidClass:"obp-vpaid"}}init(){const e=this;return this.initializing=!0,new Promise(((t,i)=>{const s=e.videoContainer,n='<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"></head><body style="margin:0;padding:0"><div class="ad-element"></div><script type="text/javascript" src="{{iframeURL_JS}}"><\/script><script type="text/javascript">window.parent.postMessage(\'{"event": "ready", "id": "{{iframeID}}"}\', \''+(window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""))+"');<\/script></body></html>";s.content.elm.classList.add(e.style.vpaidClass),s.video.elm.setAttribute("playsinline","true"),e.bridge=new se(s.content.elm,s.video.elm,{template:n}),e.bridge.loadAdUnit(e.media.fileURL,e.onload.bind(e,t,i))}))}onload(e,t,i,s){i?t(i):(this.adUnit=s,s._videoEl.addEventListener("progress",this.onProgress.bind(this)),s.subscribe("AdLoaded",this.onInit.bind(this)),s.subscribe("AdError",this.onError.bind(this)),s.subscribe("AdStarted",this.onEvent.bind(this,"adstarted")),s.subscribe("AdStopped",this.onEvent.bind(this,"adstopped")),s.subscribe("AdPaused",this.onEvent.bind(this,"adpaused")),s.subscribe("AdPlaying",this.onEvent.bind(this,"adresumed")),s.subscribe("AdSkipped",this.onEvent.bind(this,"adskipped")),s.subscribe("AdVideoComplete",this.onEvent.bind(this,"adcomplete")),s.subscribe("AdVolumeChange",this.onEvent.bind(this,"advolumechanged")),s.subscribe("AdClickThru",this.onClickThru.bind(this)),s.subscribe("Overlay.click",this.onCtaClick.bind(this)),s.subscribe("AdUserClose",this.onCtaClick.bind(this)),s.subscribe("AdVideoFirstQuartile",this.onEvent.bind(this,"adfirstquartile")),s.subscribe("AdVideoMidpoint",this.onEvent.bind(this,"admidpoint")),s.subscribe("AdVideoThirdQuartile",this.onEvent.bind(this,"adthirdquartile")),s.subscribe("AdUserAcceptInvitation",this.onEvent.bind(this,"aduseracceptinvitation")),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach((e=>{document.addEventListener(e,this.onFullscreen.bind(this))})),["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"].forEach((e=>{document.addEventListener(e,this.onFullscreenError.bind(this))})),s.handshakeVersion("2.0",this.onHandShake.bind(this)),this.shouldTrackMoat&&this.prepareMoatTracking(),e(!0))}onHandShake(e){e?this.onError(e):this.adUnit.initAd(window.innerWidth,window.innerHeight,"normal",-1,{AdParameters:this.media.adParameters},{})}onInit(){this.initializing=!1;for(const e in this.delayedEvents)if(this.delayedEvents.hasOwnProperty(e)){const t=this.delayedEvents[e];if(this.delayedEvents[e])switch(e){case"resize":null!==t.w&&null!==t.h&&(this.resize(t.w,t.h),t.w=0,t.h=0);break;case"mute":this.mute(),this.delayedEvents[e]=!1;break;case"unmute":this.unmute(),this.delayedEvents[e]=!1;break;case"volume":null!==t.val&&(this.volume(t.val),t.val=null);break;case"seek":null!==t.val&&(this.seek(t.val),t.val=null);break;case"stop":this.stop(),this.delayedEvents[e]=!1;break;case"pause":this.pause(),this.delayedEvents[e]=!1;break;case"resume":this.resume(),this.delayedEvents[e]=!1}}this.media&&this.media.jsTrackers&&this.jsTrackingEvent(this.media.jsTrackers),this.onEvent("ready"),this.onEvent("adloaded")}onError(e){let t;e&&e.message?t=e.message:e&&e instanceof Array&&(t=e.toString()),this.error=t;const i=new CustomEvent("aderror",{detail:this.error,bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(i)}onProgress(e){const t=e.srcElement.buffered;t.length&&this.broadcast("progress",{start:e.srcElement.buffered.start(t.length-1),end:e.srcElement.buffered.end(t.length-1)})}onEvent(e){let t=null;if("adstarted"===e){try{const e=this.videoContainer.video.elm;this.options.muted&&!e.muted&&this.forceMuteAfterPlay()}catch(e){}this.started=!0,this.videoStartedPlaying=!0,t=this.parent.getOpaVideoData(),this.options.shouldNotifyPlayerOnAdRendered||(this.sendMoatEvent("AdVideoStart"),this.media.impressions&&this.trackingEvents(this.media.impressions),this.media.trackingEvents.start&&this.trackingEvents(this.media.trackingEvents.start))}"aduserclose"===e&&(this.playing=!1,this.media.trackingEvents.close&&this.trackingEvents(this.media.trackingEvents.close)),"adstopped"===e&&this.sendMoatEvent("AdStopped"),"adpaused"===e&&(this.playing=!1,this.sendMoatEvent("AdPaused")),"adresumed"===e&&(this.playing=!0,this.sendMoatEvent("AdPlaying")),"adcomplete"===e&&(this.playing=!1,this.started=!1,this.media.trackingEvents.complete&&this.trackingEvents(this.media.trackingEvents.complete),this.sendMoatEvent("AdVideoComplete")),"adfirstquartile"===e&&(this.playing=!0,this.media.trackingEvents.firstQuartile&&this.trackingEvents(this.media.trackingEvents.firstQuartile),this.sendMoatEvent("AdVideoFirstQuartile")),"admidpoint"===e&&(this.playing=!0,this.media.trackingEvents.midpoint&&this.trackingEvents(this.media.trackingEvents.midpoint),this.sendMoatEvent("AdVideoMidpoint")),"adthirdquartile"===e&&(this.playing=!0,this.media.trackingEvents.thirdQuartile&&this.trackingEvents(this.media.trackingEvents.thirdQuartile),this.sendMoatEvent("AdVideoThirdQuartile")),"aduseracceptinvitation"===e&&this.media.trackingEvents.acceptInvitation&&this.trackingEvents(this.media.trackingEvents.acceptInvitation);const i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:t});this.videoContainer.elm.dispatchEvent(i),this.broadcast(e)}onClickThru(e){const t=new CustomEvent("adclick",{bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(t),e.playerHandles&&(this.media.videoClickTrackingURLTemplates&&this.trackingEvents(this.media.videoClickTrackingURLTemplates),window.open(e.url,"_blank"))}sendMoatEvent(e){if(!this.moatTracker)return;const t={type:e,adVolume:this.getVolume()};this.moatTracker.dispatchEvent(t)}onCtaClick(){}onFullscreen(e){if(e.target.id===this.id){const e=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;e?this.videoContainer.elm.classList.add("omp-expanded"):this.videoContainer.elm.classList.remove("omp-expanded");const t=e?"enterfullscreen":"exitfullscreen";e&&this.media.trackingEvents.fullscreen&&this.trackingEvents(this.media.trackingEvents.fullscreen),this.onEvent(t)}}onFullscreenError(e){const t=new CustomEvent("playererror",{detail:e,bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(t),this.broadcast("fullscreenerrror")}onPlayingMediaError(e){const t=new CustomEvent("playererror",{detail:e,bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(t),this.broadcast("playererror")}hasFullscreen(){const e=this.videoContainer.elm;return e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen}subscribe(e,t){this.subscriptions.hasOwnProperty(e)&&this.subscriptions[e].push(t)}broadcast(e,...t){if(this.subscriptions.hasOwnProperty(e)){const i=this.subscriptions[e].length;let s=0;for(;s<i;s++)this.subscriptions[e][s](e,...t)}}replaceMacros(e){return e.replaceAll("{ivc_ad_id}",this.validateMacros(this.recData.adId)).replaceAll("{ivc_widget_name}",this.validateMacros(this.recData.widgetID)).replaceAll("{ivc_widget_id}",this.validateMacros(this.recData.widgetNumberId)).replaceAll("{ivc_ad_title}",this.validateMacros(this.recData.title)).replaceAll("{ivc_source_id}",this.validateMacros(this.recData.sourceId)).replaceAll("{ivc_req_id}",this.validateMacros(this.recData.reqId)).replaceAll("{ivc_campaign_id}",this.validateMacros(this.recData.campaignId)).replaceAll("{ivc_publisher_id}",this.validateMacros(this.recData.publisherId)).replaceAll("{ivc_publisher_name}",this.validateMacros(this.recData.publisherName)).replaceAll("{ivc_adv_name}",this.validateMacros(this.recData.sourceName)).replaceAll("{ivc_time_stamp}",this.validateMacros(this.recData.timestamp)).replaceAll("{ivc_doc_id}",this.validateMacros(this.recData.did)).replaceAll("{ivc_ext_ad_id}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.adId):"").replaceAll("{ivc_ext_source_id}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.sourceId):"").replaceAll("{ivc_ext_campaign_id}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.campaignId):"").replaceAll("{ivc_ext_publisher_id}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.publisherId):"").replaceAll("{ivc_ext_doc_id}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.did):"").replaceAll("{{ad_id}}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.adId):"").replaceAll("{{widget_name}}",this.validateMacros(this.recData.widgetID)).replaceAll("{{widget_id}}",this.validateMacros(this.recData.widgetNumberId)).replaceAll("{{ad_title}}",this.validateMacros(this.recData.title)).replaceAll("{{section_id}}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.sourceId):"").replaceAll("{{req_id}}",this.validateMacros(this.recData.reqId)).replaceAll("{{campaign_id}}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.campaignId):"").replaceAll("{{publisher_id}}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.publisherId):"").replaceAll("{{publisher_name}}",this.validateMacros(this.recData.publisherName)).replaceAll("{{adv_name}}",this.validateMacros(this.recData.sourceName)).replaceAll("{{time_stamp}}",this.validateMacros(this.recData.timestamp)).replaceAll("{{doc_id}}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.did):"").replaceAll("{ivc_ob_click_id}",this.validateMacros(this.recData.obClickId)).replaceAll("{{ob_click_id}}",this.validateMacros(this.recData.obClickId)).replaceAll("{{time_stamp}}",Date.now().toString())}validateMacros(e){return e||""}prepareMoatTracking(){const e=this.videoContainer.elm,t={level1:this.options.publisherId,level2:this.options.publisherName,level3:this.options.widgetId,level4:this.options.domain,slicer1:this.options.partnerId,slicer2:this.options.marketerName},i=this.getAdDuration();this.moatTracker=this.initMoatTracking(e,t,i,"zemantajsvideo256634828520")}initMoatTracking(e,t,i,s,n,r){const a=document.createElement("script");let o=[];const l={vidIntType:"3",vidIntVersion:"1.0",adData:{ids:t,duration:i,url:n},dispatchEvent:function(e){l.sendEvent?(o&&(o.push(e),e=o,o=!1),l.sendEvent(e)):o&&o.push(e)},clientCallback:r};let d,c;t="_moatApi"+Math.floor(1e8*Math.random());try{d=e.ownerDocument,c=d.defaultView||d.parentWindow}catch(e){d=document,c=window}return c[t]=l,a.type="text/javascript",e&&e.insertBefore(a,e.childNodes[0]||null),a.src="https://z.moatads.com/"+s+"/moatvideo.js#"+t,l}trackingEvents(e){for(let t=0;t<e.length;t++){const i=this.recData?this.replaceMacros(e[t]):e[t];(new Image).src=i;const s=new CustomEvent("pixelfired",{detail:i,bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(s),this.broadcast("pixelfired")}}jsTrackingEvent(e){const t=this.videoContainer.video.elm.parentElement;for(let i=0;i<e.length;i++){const s=document.createElement("script");s.setAttribute("type","text/javascript"),s.src=e[i],t.appendChild(s);const n=new CustomEvent("jsTrackerAdded",{detail:e[i],bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(n),this.broadcast("jsTrackerAdded")}}play(){try{this.adUnit.startAd(),this.playing=!0}catch(e){this.onError(e)}}stop(){try{this.adUnit._videoEl.paused||(this.adUnit._videoEl.pause(),this.adUnit.stopAd()),this.playing=!1}catch(e){return this.onPlayingMediaError(new Error("No video element in VPAID"))}}pause(){this.adUnit.pauseAd(),this.playing=!1,this.media.trackingEvents.pause&&this.trackingEvents(this.media.trackingEvents.pause)}resume(){this.adUnit.resumeAd(),this.playing=!0,this.media.trackingEvents.resume&&this.trackingEvents(this.media.trackingEvents.resume)}mute(e=!0,t=!0){this.adUnit._videoEl.muted=!0,this.media.trackingEvents.mute&&this.trackingEvents(this.media.trackingEvents.mute),this.currentVolume=0,e&&this.onEvent("advolumechanged"),t&&this.broadcast("mute"),this.sendMoatEvent("AdVolumeChange")}onVolumeError(e){if(!e)return;const t=new CustomEvent("playererror",{detail:{message:e.message,canContinuePlay:!0},bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(t)}unmute(e=!0,t=!0){this.adUnit&&(this.adUnit._videoEl.muted=!1,0===this.lastPlayedVolume&&(this.lastPlayedVolume=1),this.currentVolume=this.lastPlayedVolume,this.media.trackingEvents.unmute&&this.trackingEvents(this.media.trackingEvents.unmute),e&&(this.onEvent("advolumechanged"),this.sendMoatEvent("AdVolumeChange")),t&&this.broadcast("unmute"))}forceMuteAfterPlay(){this.adUnit._videoEl.muted=!0,this.currentVolume=0;const e=new CustomEvent("playererror",{detail:{message:"sound on",canContinuePlay:!0},bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(e)}volume(e,t=!0){try{this.adUnit?(this.adUnit.setAdVolume(e,this.onVolumeError.bind(this)),this.lastPlayedVolume=this.currentVolume=e,t&&(this.broadcast("volume"),this.sendMoatEvent("AdVolumeChange"))):this.delayedEvents.volume.val=e}catch(e){this.onError(e)}}seek(e,t=!0){this.adUnit?(this.adUnit._videoEl.currentTime=e,t&&this.broadcast("seek")):this.delayedEvents.seek.val=e}fullscreen(){const e=this.videoContainer.elm;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()}collapse(){document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement?document.webkitExitFullscreen():document.mozFullScreenElement?document.mozCancelFullScreen():document.msFullscreenElement&&document.msExitFullscreen()}resize(e,t){this.adUnit&&t>0&&e>0?this.adUnit.resizeAd(e,t,"normal"):this.delayedEvents.resize={w:e,h:t}}clickToPlay(){this.onEvent("clicktoplay")}destroy(){const e=new CustomEvent("destroycompleted",{bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(e)}isMuted(){try{return this.adUnit._videoEl.muted}catch(e){return null}}getVolume(){return this.currentVolume}getAdPaused(){try{return this.adUnit._videoEl.paused}catch(e){return null}}getAdErrorCode(){return this.error.errorCode}getAdErrorMessage(){return this.error.message}getAdMediaHeight(){try{return this.adUnit._videoEl.videoHeight}catch(e){return 0}}getAdMediaWidth(){try{return this.adUnit._videoEl.videoWidth}catch(e){return 0}}getAdMediaUrl(){try{return this.adUnit._videoEl.src}catch(e){return null}}getAdTagUrl(){return this.media.fileURL}getAdDuration(){try{const e=this.adUnit._creative.getAdDuration();return e&&e>0?e:this.media.duration}catch(e){return 0}}getAdCurrentTime(){try{let e=this.adUnit._creative.getAdRemainingTime();e<0&&(e=0);const t=this.adUnit._creative.getAdDuration();return t-e||this.adUnit._videoEl.currentTime}catch(e){return 0}}getAdSystem(){return this.media.system}getVideoBitrate(){return this.media.bitrate}getAdMediaBitrateArray(){return null}getHeavyAdStatus(){return"vpaid"}getAdDeliveryType(){return this.media.deliveryType}getVastWidth(){try{return this.media.width}catch(e){return 0}}getVastHeight(){try{return this.media.height}catch(e){return 0}}getVideoClickThroughURL(){try{return this.media.videoClickThroughURLTemplate}catch(e){return 0}}getVideoClickTrackingURL(){try{return this.media.videoClickTrackingURLTemplates}catch(e){return 0}}getCompanionAds(){try{return this.companionAds}catch(e){return 0}}updateMacros(e){try{this.recData.obClickId=e.clickId}catch(e){}}notifyVideoHasBeenRendered(e){e===this.options.widgetIdx&&(this.sendMoatEvent("AdVideoStart"),this.media.impressions&&this.trackingEvents(this.media.impressions),this.media.trackingEvents.start&&this.trackingEvents(this.media.trackingEvents.start))}};const{OmidSessionClient:{AdEvents:re,AdSession:ae,Context:oe,MediaEvents:le,Partner:de,VerificationScriptResource:ce}}=i(769),he=["ready","adstarted","adstopped","adpaused","adresumed","adcomplete","advolumechanged","adfirstquartile","admidpoint","adthirdquartile"];class ue{static _isLoaded=!1;static _adSession=null;static _mediaEvents=null;static _adEvents=null;static _reportingElement=null;static _videoElement=null;static reset(){ue._reportingElement&&he.forEach((e=>{ue._reportingElement.removeEventListener(e,ue._reportingElementDispatchEvent)})),ue._adSession&&ue._adSession.finish(),ue._adSession=null,ue._mediaEvents=null,ue._adEvents=null,ue._reportingElement=null,ue._videoElement=null}static createAdSession(e,t,i){return ue.reset(),ue._reportingElement=t,ue._videoElement=i,he.forEach((e=>{ue._reportingElement.addEventListener(e,ue._reportingElementDispatchEvent)})),new Promise((t=>{ue._isLoaded?(ue._omSdkReady(e),t(ue)):(console.warn("createAdSession was called before initialize, initializing sdk..."),ue.initialize().then((()=>{ue._omSdkReady(e),t(ue)})))})).catch((e=>{throw e}))}static initialize(){return new Promise((e=>{if(ue._isLoaded)return e();const t=document.createElement("script");t.src="https://libs.outbrain.com/video/outbrain-media-player/current/omweb-v1.js",t.onload=()=>{ue._isLoaded=!0,e()},document.body.appendChild(t)}))}static _omSdkReady(e){ue._adSession=ue._createSession(e),ue._adSession.setCreativeType("video"),ue._adSession.isSupported()&&(ue._adEvents=new re(ue._adSession),ue._mediaEvents=new le(ue._adSession),ue._adSession.start())}static _createSession(e){const t=new de(a.omidPartnerName,a.omidPartnerVersion),i=e.map((e=>new ce(e.verificationScriptUrl,e.vendorKey,e.verificationParameters,"creative"))),s=window.location.href,n=new oe(t,i,s);return n.setVideoElement(ue._videoElement),n.setServiceWindow(window.top),new ae(n)}static _reportingElementDispatchEvent(e){if(ue._adSession&&ue._adEvents&&ue._mediaEvents)switch(e.type){case"ready":ue._adEvents.loaded();break;case"adstarted":ue._mediaEvents.start(ue._videoElement.duration,ue._videoElement.volume);break;case"adpaused":ue._mediaEvents.pause();break;case"adresumed":ue._mediaEvents.resume();break;case"advolumechanged":const t=ue._videoElement.muted?0:ue._videoElement.volume;ue._mediaEvents.volumeChange(t);break;case"adfirstquartile":ue._mediaEvents.firstQuartile();break;case"admidpoint":ue._mediaEvents.midpoint();break;case"adthirdquartile":ue._mediaEvents.thirdQuartile();break;case"adcomplete":ue._mediaEvents.complete(),ue._finishSession();break;case"adstopped":ue._mediaEvents.skipped(),ue._finishSession();break;default:console.warn("unhandled event "+e.type)}else console.warn("video event triggered before sdk is ready")}static _finishSession(){setTimeout((()=>{ue._adSession&&ue._adSession.finish(),ue.reset()}),3e3)}}var me=ue;var pe=class{constructor(e,t,i){this.parent=e,this.medias=t.medias,this.companionAds=t.companionAds,this.sortedMedias={},this.sortedAspects=[],this.media=null,this.icons=[],this.id=e.id,this.recData=e.options?e.options.adData:void 0,this.parser=t,this.shouldTrackMoat=e.shouldTrackMoat,this.options=e.options,this.moatTracker=null,this.error=null,this.playing=!1,this.started=!1,this.videoStartedPlaying=!1,this.videoInterval=0,this.qualityInterval=0,this.iconInterval=0,this.hlsInterval=0,this.switching=0,this.quartiles={first:!1,second:!1,third:!1},this.subscriptions={ready:[],adstarted:[],adstopped:[],adpaused:[],adresumed:[],adcomplete:[],advolumechanged:[],adclick:[],volume:[],mute:[],unmute:[],seek:[],progress:[],enterfullscreen:[],exitfullscreen:[],fullscreenerror:[]},this.videoContainer=i,this.initializing=!1,this.currentVolume=e.options.muted?0:1,this.lastPlayedVolume=this.currentVolume,this.sortMedias(),!0===e.options.bitrateEnabled?this.setMediaByBitrate():this.setMedia(),this.setIcons()}sortMedias(){let e=0;const t=this.medias.length,i=e=>{const t=(e.width/e.height).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0],i=`${e.width}*${e.height}`;this.sortedMedias.hasOwnProperty(t)||(this.sortedMedias[t]={}),this.sortedMedias[t].hasOwnProperty(i)||(this.sortedMedias[t][i]=[]),this.sortedAspects.indexOf(i)<0&&this.sortedAspects.push(i),this.sortedMedias[t][i].push(e)};for(;e<t;e++){if("VPAID"===this.medias[e].apiFramework)continue;const t=this.medias[e].mimeType,s=this.medias[e].fileURL.split(".").pop();t?"video/mp4"!==t&&"video/quicktime"!==t&&"application/x-mpegURL"!==t&&"application/vnd.apple.mpegurl"!==t||(this.medias[e].isSlh="application/x-mpegURL"===t||"application/vnd.apple.mpegurl"===t||"m3u8"===s.substring(0,4).toLowerCase(),i(this.medias[e])):"mp4"!==s.toLowerCase()&&"mov"!==s.toLowerCase()&&"m3u8"!==s.toLowerCase()||(this.medias[e].isSlh="m3u8"===s.toLowerCase(),i(this.medias[e]))}this.sortedAspects.sort(((e,t)=>{const i=e.split("*"),s=t.split("*"),n=parseInt(i[0]),r=parseInt(i[1]),a=parseInt(s[0]),o=parseInt(s[1]);return n<a||r<o?1:n>a||r>o?-1:0}));for(const e in this.sortedMedias)if(this.sortedMedias.hasOwnProperty(e))for(const t in this.sortedMedias[e])this.sortedMedias[e].hasOwnProperty(t)&&this.sortedMedias[e][t].sort(((e,t)=>e.hasOwnProperty("bitrate")&&t.hasOwnProperty("bitrate")?e.bitrate<t.bitrate?1:-1:0))}setMedia(){if(this.sortedMedias&&Object.keys(this.sortedMedias).length){const e=this.sortedAspects[0];let t;for(let i=0;i<Object.keys(this.sortedMedias).length;i++){const s=this.sortedMedias[Object.keys(this.sortedMedias)[i]];s.hasOwnProperty(e)&&(t=s)}this.media=t[e][0]}}setMediaByBitrate(){let e=0;const t=this.getHeavyAdStatus(),i=this.getAdMediaBitrateArray();if(this.sortedMedias&&Object.keys(this.sortedMedias).length){let s;for(let n=0;n<Object.keys(this.sortedMedias).length;n++){const r=this.sortedMedias[Object.keys(this.sortedMedias)[n]];if("reducedLarge"===t||"reducedMed"===t){const n="reducedLarge"===t?1200:800;i.some((t=>t<n&&t>e))&&(e=Math.max(...i.filter((t=>t<n&&t>e)))),Object.keys(r).forEach((function(t){r[t].some((t=>t.bitrate===e))&&(s=r[t].find((t=>t.bitrate===e)))}))}else{const e=this.sortedAspects[0];r.hasOwnProperty(e)&&(s=r[e][0])}}this.media=s}}getMedia(){return this.media}setIcons(){if(this.parser&&this.parser.vast&&this.parser.vast.ads&&this.parser.vast.ads[0]&&this.parser.vast.ads[0].creatives&&this.parser.vast.ads[0].creatives[0]&&this.parser.vast.ads[0].creatives[0].icons&&Array.isArray(this.parser.vast.ads[0].creatives[0].icons))for(let e=0;e<this.parser.vast.ads[0].creatives[0].icons.length;e++)try{this.icons.push({iconData:this.parser.vast.ads[0].creatives[0].icons[e],endTime:parseInt(this.parser.vast.ads[0].creatives[0].icons[e].duration)>0?Math.max(0,parseInt(this.parser.vast.ads[0].creatives[0].icons[e].offset))+parseInt(this.parser.vast.ads[0].creatives[0].icons[e].duration):-1,visible:!1})}catch(e){}}init(){const e=this;return this.initializing=!0,new Promise(((t,i)=>{const s=e.videoContainer;s.video.elm.src=this.media.fileURL,this.media.isSlh&&!s.video.elm.canPlayType("application/vnd.apple.mpegurl")?this.loadHlsForStream(t,i):this.addListeners(t,i)}))}checkIfRequireOnPage(){return void 0!==window.require&&void 0!==window.require.config}loadHlsForStream(e,t){if("undefined"==typeof Hls){const i="https://libs.outbrain.com/video/outbrain-player/hls.min.js",s=this;if(this.checkIfRequireOnPage())try{window.require([i],(function(e){window.Hls=e,window.Date=Date}));let n=20;this.hlsInterval=setInterval((()=>{"undefined"!=typeof Hls&&(clearInterval(this.hlsInterval),s.loadHlsMedia(e,t)),n--,n<1&&(clearInterval(this.hlsInterval),t("require has not loaded hls on page"))}),500)}catch(e){return this.onPlayingMediaError(new Error("Could not use require js. "+e.toString())),t()}else{const s=document.createElement("script");s.src=i,s.onload=this.loadHlsMedia.bind(this,e,t),document.getElementsByTagName("head")[0].appendChild(s)}}else this.loadHlsMedia(e,t)}loadHlsMedia(e,t){try{const i=this.videoContainer.video.elm;if(Hls.isSupported()){const s=new Hls;s.loadSource(this.media.fileURL),s.attachMedia(i),i.preload="metadata",this.addListeners(e,t)}t("Could not find HLS script")}catch(e){t(e)}}addListeners(e,t){try{const i=this.videoContainer.video.elm;i.addEventListener("progress",this.onProgress.bind(this)),i.addEventListener("ended",this.onComplete.bind(this)),i.addEventListener("click",this.onClick.bind(this)),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach((e=>{document.addEventListener(e,this.onFullscreen.bind(this))})),["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"].forEach((e=>{document.addEventListener(e,this.onFullscreenError.bind(this))})),this.media.adVerifications&&this.media.adVerifications.length>0?me.initialize().then((()=>{e(!0),this.callOnInit()})).catch(t):(e(!0),this.callOnInit())}catch(e){t(e)}}callOnInit(){setTimeout((()=>{this.onInit()}),500)}onInit(){this.initializing=!1,this.media&&this.media.jsTrackers&&this.jsTrackingEvent(this.media.jsTrackers),this.onEvent("ready"),this.onEvent("adloaded")}onProgress(e){const t=e.srcElement.buffered;t.length&&this.broadcast("progress",{start:e.srcElement.buffered.start(t.length-1),end:e.srcElement.buffered.end(t.length-1)})}onComplete(){this.end(),this.playing=!1,this.started=!1,this.media.trackingEvents.complete&&this.trackingEvents(this.media.trackingEvents.complete),this.onEvent("adcomplete")}onClick(e){if(e.preventDefault(),this.pause(),this.media.videoClickThroughURLTemplate){if(this.recData){const e=this.replaceMacros(this.media.videoClickThroughURLTemplate);window.open(e,"_blank")}else window.open(this.media.videoClickThroughURLTemplate,"_blank");this.media.videoClickTrackingURLTemplates&&this.trackingEvents(this.media.videoClickTrackingURLTemplates)}this.onEvent("adclick")}onEvent(e,t){const i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:t});this.videoContainer.elm.dispatchEvent(i),this.broadcast(e),this.checkMoatEvent(e)}checkMoatEvent(e){if(this.shouldTrackMoat)switch(e){case"ready":this.prepareMoatTracking();break;case"adstarted":this.options.shouldNotifyPlayerOnAdRendered||this.sendMoatEvent("AdVideoStart");break;case"adstopped":this.sendMoatEvent("AdStopped");break;case"adfirstquartile":this.sendMoatEvent("AdVideoFirstQuartile");break;case"admidpoint":this.sendMoatEvent("AdVideoMidpoint");break;case"adthirdquartile":this.sendMoatEvent("AdVideoThirdQuartile");break;case"adcomplete":this.sendMoatEvent("AdVideoComplete");break;case"adpaused":this.sendMoatEvent("AdPaused");break;case"adresumed":this.sendMoatEvent("AdPlaying");break;case"advolumechanged":this.sendMoatEvent("AdVolumeChange")}}sendMoatEvent(e){if(!this.moatTracker)return;const t={type:e,adVolume:this.getVolume()};this.moatTracker.dispatchEvent(t)}onFullscreen(e){if(e.target.id===this.id){const e=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;e?this.videoContainer.elm.classList.add("omp-expanded"):this.videoContainer.elm.classList.remove("omp-expanded");const t=e?"enterfullscreen":"exitfullscreen";this.media.trackingEvents.fullscreen&&this.trackingEvents(this.media.trackingEvents.fullscreen),this.onEvent(t)}}onFullscreenError(e){const t=new CustomEvent("playererror",{detail:e,bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(t),this.broadcast("fullscreenerrror")}onPlayingMediaError(e){const t=new CustomEvent("playererror",{detail:e,bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(t),this.broadcast("playererror")}hasFullscreen(){const e=this.videoContainer.elm;return e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen}start(){this.end(),this.started=!0,this.videoInterval=setInterval((()=>{if(this.playing){const e=this.videoContainer.video.elm,t=100*e.currentTime/e.duration;t>=25&&!this.quartiles.first?(this.quartiles.first=!0,this.media.trackingEvents.firstQuartile&&this.trackingEvents(this.media.trackingEvents.firstQuartile),this.onEvent("adfirstquartile")):t>=50&&!this.quartiles.second?(this.quartiles.second=!0,this.media.trackingEvents.midpoint&&this.trackingEvents(this.media.trackingEvents.midpoint),this.onEvent("admidpoint")):t>=75&&!this.quartiles.third&&(this.quartiles.third=!0,this.media.trackingEvents.thirdQuartile&&this.trackingEvents(this.media.trackingEvents.thirdQuartile),this.onEvent("adthirdquartile"))}}),1e3),this.iconInterval=setInterval((()=>{if(this.playing&&this.icons.length>0){const e=this.videoContainer.video.elm;for(let t=0;t<this.icons.length;t++)!this.icons[t].visible&&this.icons[t].iconData.offset<=e.currentTime&&(this.icons[t].endTime>=e.currentTime||-1===this.icons[t].endTime)&&this.displayIcon(this.icons[t],t),this.icons[t].visible&&(e.currentTime<=this.icons[t].iconData.offset||this.icons[t].endTime>-1&&this.icons[t].endTime<=e.currentTime)&&this.removeIcon(t)}}),300)}displayIcon(e,t){const i=document.createElement("img");i.className="omp-vast-icons",i.id="omp-vast-icon-"+t,i.style.width=parseInt(e.iconData.width)/10+"%";const s=e.iconData.xPosition;"left"===s?i.style.left="0px":"right"===s?i.style.right="0px":"center"===s?(i.style.left="50%",i.style.transform="translate(-50%, 0)"):parseInt(s)>=0?i.style.left=s+"%":i.style.left="5%";const n=e.iconData.yPosition;"top"===n?i.style.top="0px":"bottom"===n?i.style.bottom="50px":"middle"===n?(i.style.top="50%",i.style.transform?i.style.transform="translate(-50%, -50%)":i.style.transform="translate(0, -50%)"):parseInt(n)>=0?(i.style.setProperty("bottom",n+"%","important"),i.style.transform=`translate(-${s}%, ${n}%)`):i.style.bottom="0px",void 0!==e.iconData.iconViewTrackingURLTemplate&&i.addEventListener("load",this.onIconLoadPingTracking.bind(this,e.iconData)),void 0!==e.iconData.iconClickThroughURLTemplate&&(i.addEventListener("touchend",this.onIconClickThrough.bind(this,e.iconData)),i.addEventListener("click",this.onIconClickThrough.bind(this,e.iconData))),i.src=e.iconData.staticResource,this.videoContainer.elm.appendChild(i),e.visible=!0}removeIcon(e){const t=document.getElementById("omp-vast-icon-"+e);t&&(this.videoContainer.elm.removeChild(t),this.icons[e].visible=!1)}onIconLoadPingTracking(e){const t=document.createElement("img");t.style.width="1px",t.style.height="1px",t.style.opacity="0",t.src=e.iconViewTrackingURLTemplate,this.videoContainer.elm.appendChild(t)}onIconClickThrough(e,t){if(t.preventDefault(),this.pause(),e.iconClickThroughURLTemplate){if(this.recData){const t=this.replaceMacros(e.iconClickThroughURLTemplate);window.open(t,"_blank")}else window.open(e.iconClickThroughURLTemplate,"_blank");e.iconClickTrackingURLTemplates&&this.trackingEvents(e.iconClickTrackingURLTemplates)}this.onEvent("adclick")}checkQuality(){this.qualityInterval=setInterval((()=>{const e=document.createElement("img"),t=document.getElementsByTagName("body")[0],i=this;let s=null;e.src="http://widgets.outbrain.com/images/widgetIcons/ob_logo_67x12@2x.png",e.style.position="absolute",e.style.opacity=0,e.onload=()=>{const n=Date.now()-s;t.removeChild(e),n<500?i.higherQuality():i.lowerQuality()},t.appendChild(e),s=Date.now()}),3e4)}end(){this.videoInterval&&clearInterval(this.videoInterval),this.iconInterval&&clearInterval(this.iconInterval),this.qualityInterval&&clearInterval(this.qualityInterval),this.hlsInterval&&clearInterval(this.hlsInterval),this.quartiles={first:!1,second:!1,third:!1}}subscribe(e,t){this.subscriptions.hasOwnProperty(e)&&this.subscriptions[e].push(t)}broadcast(e,...t){if(this.subscriptions.hasOwnProperty(e)){const i=this.subscriptions[e].length;let s=0;for(;s<i;s++)this.subscriptions[e][s](e,...t)}}replaceMacros(e){return e.replaceAll("{ivc_ad_id}",this.validateMacros(this.recData.adId)).replaceAll("{ivc_widget_name}",this.validateMacros(this.recData.widgetID)).replaceAll("{ivc_widget_id}",this.validateMacros(this.recData.widgetNumberId)).replaceAll("{ivc_ad_title}",this.validateMacros(this.recData.title)).replaceAll("{ivc_source_id}",this.validateMacros(this.recData.sourceId)).replaceAll("{ivc_req_id}",this.validateMacros(this.recData.reqId)).replaceAll("{ivc_campaign_id}",this.validateMacros(this.recData.campaignId)).replaceAll("{ivc_publisher_id}",this.validateMacros(this.recData.publisherId)).replaceAll("{ivc_publisher_name}",this.validateMacros(this.recData.publisherName)).replaceAll("{ivc_adv_name}",this.validateMacros(this.recData.sourceName)).replaceAll("{ivc_time_stamp}",this.validateMacros(this.recData.timestamp)).replaceAll("{ivc_doc_id}",this.validateMacros(this.recData.did)).replaceAll("{ivc_ext_ad_id}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.adId):"").replaceAll("{ivc_ext_source_id}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.sourceId):"").replaceAll("{ivc_ext_campaign_id}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.campaignId):"").replaceAll("{ivc_ext_publisher_id}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.publisherId):"").replaceAll("{ivc_ext_doc_id}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.did):"").replaceAll("{{ad_id}}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.adId):"").replaceAll("{{widget_name}}",this.validateMacros(this.recData.widgetID)).replaceAll("{{widget_id}}",this.validateMacros(this.recData.widgetNumberId)).replaceAll("{{ad_title}}",this.validateMacros(this.recData.title)).replaceAll("{{section_id}}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.sourceId):"").replaceAll("{{req_id}}",this.validateMacros(this.recData.reqId)).replaceAll("{{campaign_id}}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.campaignId):"").replaceAll("{{publisher_id}}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.publisherId):"").replaceAll("{{publisher_name}}",this.validateMacros(this.recData.publisherName)).replaceAll("{{adv_name}}",this.validateMacros(this.recData.sourceName)).replaceAll("{{time_stamp}}",this.validateMacros(this.recData.timestamp)).replaceAll("{{doc_id}}",this.recData.externalIds?this.validateMacros(this.recData.externalIds.did):"").replaceAll("{ivc_ob_click_id}",this.validateMacros(this.recData.obClickId)).replaceAll("{{ob_click_id}}",this.validateMacros(this.recData.obClickId)).replaceAll("{{time_stamp}}",Date.now().toString())}validateMacros(e){return e||""}prepareMoatTracking(){const e=this.videoContainer.elm,t={level1:this.options.publisherId,level2:this.options.publisherName,level3:this.options.widgetId,level4:this.options.domain,slicer1:this.options.partnerId,slicer2:this.options.marketerName},i=this.getAdDuration();this.moatTracker=this.initMoatTracking(e,t,i,"zemantajsvideo256634828520")}initMoatTracking(e,t,i,s,n,r){const a=document.createElement("script");let o=[];const l={vidIntType:"3",vidIntVersion:"1.0",adData:{ids:t,duration:i,url:n},dispatchEvent:function(e){l.sendEvent?(o&&(o.push(e),e=o,o=!1),l.sendEvent(e)):o&&o.push(e)},clientCallback:r};let d,c;t="_moatApi"+Math.floor(1e8*Math.random());try{d=e.ownerDocument,c=d.defaultView||d.parentWindow}catch(e){d=document,c=window}return c[t]=l,a.type="text/javascript",e&&e.insertBefore(a,e.childNodes[0]||null),a.src="https://z.moatads.com/"+s+"/moatvideo.js#"+t,l}trackingEvents(e){for(let t=0;t<e.length;t++){const i=this.recData?this.replaceMacros(e[t]):e[t];(new Image).src=i;const s=new CustomEvent("pixelfired",{detail:i,bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(s),this.broadcast("pixelfired")}}jsTrackingEvent(e){const t=this.videoContainer.video.elm.parentElement;for(let i=0;i<e.length;i++){const s=document.createElement("script");s.setAttribute("type","text/javascript"),s.src=e[i],t.appendChild(s);const n=new CustomEvent("jstrackeradded",{detail:e[i],bubbles:!1,cancelable:!0});this.videoContainer.elm.dispatchEvent(n),this.broadcast("jstrackeradded")}}getOptimalSizeVideo(e){let t=0;const i=this.sortedMedias[1.77],s=i.length,n=e.offsetHeight,r=e.offsetWidth;let a=null;for(;t<s;t++){if("VPAID"===i[t].apiFramework)continue;const e=i[t].mimeType||i[t].fileURL.split(".").pop();"video/mp4"!==e&&"mp4"!==e||i[t].height>=n&&i[t].width>=r&&(a?a.height>i[t].height&&a.width>i[t].width&&(a=i[t]):a=i[t])}return a||(a=i[i.length-1]),a}higherQuality(){const e=`${this.media.width}*${this.media.height}`,t=this.sortedAspects.indexOf(e);if(void 0!==this.sortedAspects[t+1]){const e=this.sortedAspects[t+1];if(this.sortedMedias[1.77]&&this.sortedMedias[1.77].hasOwnProperty(e)){const t=this.sortedMedias[1.77][e];this.switchMedia(t[t.length-1])}if(this.sortedMedias[1.91]&&this.sortedMedias[1.91].hasOwnProperty(e)){const t=this.sortedMedias[1.91][e];this.switchMedia(t[t.length-1])}}}lowerQuality(){const e=`${this.media.width}*${this.media.height}`,t=this.sortedAspects.indexOf(e);if(void 0!==this.sortedAspects[t-1]){const e=this.sortedAspects[t-1];if(this.sortedMedias[1.77]&&this.sortedMedias[1.77].hasOwnProperty(e)){const t=this.sortedMedias[1.77][e];this.switchMedia(t[t.length-1])}if(this.sortedMedias[1.91]&&this.sortedMedias[1.91].hasOwnProperty(e)){const t=this.sortedMedias[1.91][e];this.switchMedia(t[t.length-1])}}}switchMedia(e){if(this.switching)return;const t=this.videoContainer.video.elm,i=t.parentElement,s=t.currentTime,n=document.createElement("video"),r=parseInt(s)+1,a=this;r<t.duration&&(this.switching=1,n.style.position="absolute",n.style.visibility="hidden",n.style.zIndex="-1",n.src=e.fileURL+"#t="+r,n.onprogress=function(){if(a.switching++,a.switching>9){n.onprogress=null;const t=a.videoContainer.video.elm,i=this;a.media=e,this.style.visibility=null,this.style.zIndex=null;const s=t.muted;a.playing&&this.play(),i.currentTime=t.currentTime,i.muted=s,t.muted=!0,a.videoContainer.video.elm=n,i.parentNode.removeChild(t),i.style.position=null,i.addEventListener("progress",a.onProgress.bind(a)),i.addEventListener("ended",a.onComplete.bind(a)),a.switching=0}},i.insertBefore(n,t))}play(){const e=this.videoContainer.video.elm;this.start(),e.play().then((()=>{this.playing=!0,this.videoStartedPlaying=!0,this.media.impressions&&this.trackingEvents(this.media.impressions),this.media.trackingEvents.start&&this.trackingEvents(this.media.trackingEvents.start),this.media.adVerifications&&this.media.adVerifications.length>0&&me.createAdSession(this.media.adVerifications,this.videoContainer.elm,this.videoContainer.video.elm),setTimeout((()=>{this.media.isSlh&&(this.media.duration=e.duration)}),1e3),this.onEvent("adstarted",this.parent.getOpaVideoData())})).catch((e=>{this.onPlayingMediaError(new Error("Video did not start playing. "+e.toString()))}))}stop(){const e=this.videoContainer.video.elm;this.end(),e.pause(),this.playing=!1,this.onEvent("adstopped")}pause(){this.videoContainer.video.elm.pause(),this.playing=!1,this.media.trackingEvents.pause&&this.trackingEvents(this.media.trackingEvents.pause),this.onEvent("adpaused")}resume(){this.videoContainer.video.elm.play(),this.playing=!0,this.media.trackingEvents.resume&&this.trackingEvents(this.media.trackingEvents.resume),this.onEvent("adresumed")}mute(e=!0,t=!0){this.videoContainer.video.elm.muted=!0,this.currentVolume=0,this.media.trackingEvents.mute&&this.trackingEvents(this.media.trackingEvents.mute),e&&this.onEvent("advolumechanged"),t&&this.broadcast("mute")}unmute(e=!0,t=!0){this.videoContainer.video.elm.muted=!1,0===this.lastPlayedVolume&&(this.lastPlayedVolume=1),this.currentVolume=this.lastPlayedVolume,this.media.trackingEvents.unmute&&this.trackingEvents(this.media.trackingEvents.unmute),e&&this.onEvent("advolumechanged"),t&&this.broadcast("unmute")}volume(e,t=!0){const i=this.videoContainer.video.elm;this.lastPlayedVolume=this.currentVolume=i.volume=e,this.onEvent("advolumechanged"),t&&this.broadcast("volume")}seek(e,t=!0){this.videoContainer.video.elm.currentTime=e,t&&this.broadcast("seek")}fullscreen(){const e=this.videoContainer.elm;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()}collapse(){document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement?document.webkitExitFullscreen():document.mozFullScreenElement?document.mozCancelFullScreen():document.msFullscreenElement&&document.msExitFullscreen()}resize(e,t){}clickToPlay(){this.onEvent("clicktoplay")}destroy(){this.media.adVerifications&&this.media.adVerifications.length>0&&me.reset(),this.onEvent("destroycompleted")}isMuted(){return this.videoContainer.video.elm.muted}getVolume(){return this.currentVolume}getAdPaused(){return this.videoContainer.video.elm.paused}getAdErrorCode(){return this.error.errorCode}getAdErrorMessage(){return this.error.message}getAdSystem(){return this.media.system}getVideoBitrate(){return this.media.bitrate}getAdMediaBitrateArray(){const e=[];if(this.sortedMedias&&Object.keys(this.sortedMedias).length)for(let t=0;t<Object.keys(this.sortedMedias).length;t++){const i=this.sortedMedias[Object.keys(this.sortedMedias)[t]];Object.keys(i).forEach((function(t){e.push(...i[t].map((function(e){return e.bitrate})))}))}return e}getHeavyAdStatus(){const e=this.options,t=this.getAdMediaBitrateArray();let i="void";return t&&(i="noBitrate",t.length>0&&t.some((e=>e>0))&&(i="noMatchingTag",t.every((e=>e<800))?i="notNeeded":e.placementWidth&&e.placementHeight&&((e.placementHeight>600||e.placementWidth>600)&&t.some((e=>e<1200))?i="reducedLarge":e.placementHeight<=600&&e.placementWidth<=600&&t.some((e=>e<=800))&&(i="reducedMed")))),i}getAdMediaHeight(){return this.videoContainer.video.elm.videoHeight}getAdMediaWidth(){return this.videoContainer.video.elm.videoWidth}getAdMediaUrl(){return this.videoContainer.video.elm.src}getAdTagUrl(){return this.media.fileURL}getAdDuration(){const e=this.videoContainer.video.elm.duration;return e&&e>0?e:this.media.duration}getAdCurrentTime(){return this.videoContainer.video.elm.currentTime}getAdDeliveryType(){return this.media.deliveryType}getVastWidth(){return this.media.width}getVastHeight(){return this.media.height}getVideoClickThroughURL(){return this.media.videoClickThroughURLTemplate}getVideoClickTrackingURL(){return this.media.videoClickTrackingURLTemplates}getCompanionAds(){return this.companionAds}updateMacros(e){try{this.recData.obClickId=e.clickId}catch(e){}}notifyVideoHasBeenRendered(e){e===this.options.widgetIdx&&this.sendMoatEvent("AdVideoStart")}};class ve{static getNativeTopContentTemplate(){return'\n        <div class="omp-logo">\n            <img src="{{logoUrl}}" alt="{{sponsor}}">\n        </div>\n        <div class="omp-sponsor-brand">{{sponsor}}</div>'}static getNativeBottomContentTemplate(){return'\n     <div class="omp-native-texts-wrapper">\n      <div class="omp-native-title">{{title}}</div>\n      <div class="omp-native-description">{{description}}</div>\n     </div>'+ve.getNativeButtonTemplate()}static getInVideoNativeTemplate(){return'\n      <div class="omp-native-texts-wrapper">\n        <div class="omp-sponsor-brand">{{sponsor}}</div>\n        <div class="omp-native-title">{{title}}</div>\n      </div>'+ve.getNativeButtonTemplate()}static getNativeButtonTemplate(){return'\n     <div class="omp-native-button-wrapper">\n          <a class="omp-native-button" target="_blank" rel="noopener noreferrer" href="{{btnUrl}}">{{btnText}}</a>\n     </div>'}static createNativeUI(e,t,i,s){return s.inVideoAssets?ve.createInVideoAssets(e,t,i):ve.createNativeAssets(t,i)}static createNativeAssets(e,t){let i=ve.getNativeTopContentTemplate().replace("{{logoUrl}}",t.logoUrl).replaceAll("{{sponsor}}",t.sponsored),s=ve.getNativeBottomContentTemplate().replace("{{title}}",t.title).replace("{{description}}",t.description||"").replace("{{btnText}}",t.btnText).replace("{{btnUrl}}",t.btnUrl);const n=document.createElement("div");n.classList.add("omp-native-bottom-wrapper"),n.innerHTML=s,e.footerElement=n;const r=document.createElement("div");r.classList.add("omp-native-top-wrapper"),r.classList.add(t.logoUrl?"":"omp-native-no-logo"),r.innerHTML=i,e.headerElement=r}static createInVideoAssets(e,t,i){let s=ve.getInVideoNativeTemplate().replace("{{title}}",i.title).replaceAll("{{sponsor}}",i.sponsored).replace("{{btnText}}",i.btnText).replace("{{btnUrl}}",i.btnUrl);const n=document.createElement("div");return n.classList.add("omp-in-video-native-wrapper"),n.innerHTML=s,e.appendChild(n),n}}var ge=ve;var fe=class{constructor(e){this.parent=e,this.framework=null,this.parser=null,this.interpreter=null,this.uiTimeout=0,this.timeInfoTimeout=0,this.volumeState=this.parent.options.muted?0:1,this.lastPlayedVolume=this.volumeState,this.volumeTimer=0,this.duration=0,this.progressInterval=0,this.interpreterReady=!1,this.viewabiltyEventInterval={},this.totalContinuosViewTime=0,this.viewabiltyEventTime=2e3,this.viewabiltyIntervalTime=100,this.viewabilityPercentageThreshold=50,this.videoWasViewed=!1,this.bitrateInterval=null,this.videoCompleted=!1,this.ctwAdData=this.parent.options&&this.parent.options.adData&&this.parent.options.adData.adExtraData&&this.parent.options.adData.adExtraData[this.parent.options.adData.adId]?this.parent.options.adData.adExtraData[this.parent.options.adData.adId]:void 0,this.ctwAdDataAutoPlayEnabled=!(!this.ctwAdData||"true"!==this.ctwAdData.autoPlayEnabled),this.onPress=this.onKeyPress.bind(this),this.customControls={data:null,adIcon:{src:null,width:0,height:0}},this.elements={header:{elm:null,id:"omp-header",settings:{elm:null,className:"omp-settings",settingsIcon:{elm:null,className:"omp-settings-btn",iconClassName:"settings"}},close:{elm:null,className:"omp-close",closeIcon:{elm:null,className:"omp-close-btn",closeIconClassName:"clear"}},dummy:{elm:null,className:"omp-dummy"}},footer:{elm:null,id:"omp-footer",play:{elm:null,className:"omp-play-pause",playIcon:{elm:null,className:"omp-play-pause-btn",playIconClassName:"play_arrow",pauseIconClassName:"pause"}},seek:{elm:null,className:"omp-seek-bar-wrapper",bar:{elm:null,className:"omp-seek-bar",loadBar:{elm:null,className:"omp-load-bar"},progressBar:{elm:null,className:"omp-progress-bar"},handler:{elm:null,className:"omp-progress-handler",iconClassName:"fiber_manual_record"},time:{elm:null,className:"omp-time-info"}}},timeBox:{elm:null,className:"omp-time-box-wrapper",timeBoxDisplay:{elm:null,className:"omp-time-box"}},volume:{elm:null,className:"omp-volume",volumeIcon:{elm:null,className:"omp-volume-btn",highClassName:"high",lowClassName:"low",muteClassName:"mute",highIconClassName:"volume_up",lowIconClassName:"volume_down",muteIconClassName:"volume_off"},volumeWrapper:{elm:null,className:"omp-volume-wrapper",volumeBar:{elm:null,className:"omp-volume-bar"},volumeSeekBar:{elm:null,className:"omp-volume-seek-bar"},volumeHandler:{elm:null,className:"omp-volume-handler"}}},expand:{elm:null,className:"omp-fullscreen",expandIcon:{className:"omp-expand-btn",expandClassName:"fullscreen",collapseClassName:"collapse",expandIconClassName:"fullscreen",collapseIconClassName:"fullscreen_exit"}}},inVideoNativeAssets:{elm:null},loader:{elm:null,className:"omp-loader"},videoContainer:{elm:null,content:{elm:null,className:"obp-vpaid"},video:{elm:null}},style:{icons:"material-icons",active:"active",hidden:"omp-hidden",invisible:"omp-invisible",commonIconClassName:"omp-ui-btn",smallIconClassName:"omp-small-ui",mediumIconClassName:"omp-medium-ui",smallSeekClassName:"omp-small-seek",mediumSeekClassName:"omp-medium-seek"},adIcon:{elm:null,className:"omp-ad-icon"},thumbnailWrapper:{elm:null,className:"omp-thumbnail-wrapper",thumbnailImage:{elm:null,className:"omp-thumbnail-image"},largePlayIcon:{elm:null,className:"omp-thumbnail-large-play-icon"}}},this.init()}init(){this.parser=new I(this.parent.vastXML,this.parent.pixels,this.parent.jsTrackers),e.waterfall([this.parser.read,this.parser.setAdsMedias],this.parser).then(this.onAdReady.bind(this)).catch(this.onError.bind(this))}setUI(){this.setVideoUI(),this.setHeaderUI(),this.setFooterUI(),this.setUIFonts(),this.setUICustomControls(),this.setThumbnailUI(),this.parent.opaVideoData&&this.parent.opaVideoData.isNativeVideo&&"asOutstream"!==this.parent.options.nativeVideoMode&&(this.elements.inVideoNativeAssets.elm=this.setNativeUI());const e=document.getElementById(this.parent.id);e.addEventListener("mouseenter",this.onMouseEnter.bind(this)),e.addEventListener("mouseleave",this.onMouseLeave.bind(this)),this.parent.mobile?(this.elements.header.elm.addEventListener("click",this.onControlClick.bind(this),!0),this.elements.footer.elm.addEventListener("click",this.onControlClick.bind(this),!0),document.addEventListener("scroll",this.onControlClick.bind(this),!0)):(this.elements.header.elm.addEventListener("click",this.setFocus.bind(this),!0),this.elements.footer.elm.addEventListener("click",this.setFocus.bind(this),!0)),this.interpreter.subscribe("ready",this.onReady.bind(this)),this.interpreter.subscribe("adstarted",this.onPlay.bind(this)),this.interpreter.subscribe("adstopped",this.onStop.bind(this)),this.interpreter.subscribe("adpaused",this.onPause.bind(this)),this.interpreter.subscribe("adcomplete",this.onComplete.bind(this)),this.interpreter.subscribe("adresumed",this.onResume.bind(this)),this.interpreter.subscribe("mute",this.onVolume.bind(this)),this.interpreter.subscribe("unmute",this.onVolume.bind(this)),this.interpreter.subscribe("volume",this.onVolume.bind(this)),this.interpreter.subscribe("progress",this.onProgress.bind(this)),this.interpreter.subscribe("enterfullscreen",this.onFullscreen.bind(this)),this.interpreter.subscribe("exitfullscreen",this.onFullscreen.bind(this)),this.interpreter.subscribe("fullscreenerror",this.onFullscreenError.bind(this)),this.interpreter.subscribe("clicktoplay",this.onClickToPlay.bind(this))}setHeaderUI(){const e=this.parent.container,t=this.elements.header;this.setSettingsUI(),this.setCloseUI(),this.setDummyUI(),this.setExpandUI(),t.elm=document.createElement("div"),t.elm.id=t.id,t.elm.setAttribute("tabindex","100"),this.parent.options.outstream&&(t.elm.style.display="flex"),t.elm.appendChild(t.close.elm),t.elm.appendChild(t.settings.elm),t.elm.appendChild(t.dummy.elm),e.appendChild(t.elm)}setVideoUI(){const e=this.parent.id,t=this.elements.videoContainer;t.elm=document.getElementById(e),t.content.elm=document.createElement("div"),t.video.elm=document.createElement("video"),t.video.elm.setAttribute("playsinline","true"),t.elm.appendChild(t.content.elm),t.elm.appendChild(t.video.elm)}setThumbnailUI(){if(this.parent.options.thumbnailImage&&this.parent.options.thumbnailImage.isEnabled){const t=this.parent.container,i=this.elements.thumbnailWrapper,s=e.getElement("style",this.elements);if(i.elm=document.createElement("div"),i.elm.classList.add(i.className),i.elm.classList.add(s.hidden),this.parent.options.thumbnailImage.image){const e=i.thumbnailImage;e.elm=document.createElement("img"),e.elm.classList.add(e.className),e.elm.setAttribute("src",this.parent.options.thumbnailImage.image),i.elm.appendChild(e.elm)}const n=i.largePlayIcon;n.elm=document.createElement("img"),n.elm.classList.add(n.className),n.elm.addEventListener("click",this.onClickToPlay.bind(this)),i.elm.appendChild(n.elm),t.appendChild(i.elm)}}displayThumbnail(){const t=this.elements.thumbnailWrapper;if(t.elm){const i=e.getElement("style",this.elements);t.elm.classList.remove(i.hidden)}}setSettingsUI(){const t=e.getElement("settings",this.elements),i=document.createElement("div"),s=document.createElement("i"),n=this.parent.options;i.classList.add(t.className),i.classList.add(this.elements.style.commonIconClassName),s.classList.add(t.settingsIcon.className),s.classList.add(this.elements.style.icons),!1!==n.showSettings&&!1!==n.showControls||i.classList.add(this.elements.style.invisible),s.appendChild(document.createTextNode(t.settingsIcon.iconClassName)),i.appendChild(s),t.elm=i,t.settingsIcon.elm=s,t.elm.style.zIndex="9999"}setCloseUI(){const t=e.getElement("close",this.elements),i=document.createElement("div"),s=document.createElement("i"),n=this.parent.options;i.classList.add(t.className),i.classList.add(this.elements.style.commonIconClassName),s.classList.add(t.closeIcon.className),s.classList.add(this.elements.style.icons),!1!==n.showClose&&!1!==n.showControls||i.classList.add(this.elements.style.invisible),s.appendChild(document.createTextNode(t.closeIcon.closeIconClassName)),i.appendChild(s),t.elm=i,t.closeIcon.elm=s,t.closeIcon.elm.addEventListener("click",this.onClickClose.bind(this))}setDummyUI(){const t=e.getElement("dummy",this.elements);t.elm=document.createElement("div"),t.elm.classList.add(t.className)}setExpandUI(){const t=e.getElement("expand",this.elements),i=document.createElement("div"),s=document.createElement("i"),n=this.parent.options;i.classList.add(t.className),i.classList.add(this.elements.style.commonIconClassName),s.classList.add(t.expandIcon.className),s.classList.add(t.expandIcon.collapseClassName),s.classList.add(this.elements.style.icons),!1!==n.showExpand&&!1!==n.showControls||i.classList.add(this.elements.style.invisible),s.appendChild(document.createTextNode(t.expandIcon.expandIconClassName)),i.appendChild(s),t.elm=i,t.expandIcon.elm=s,this.interpreter.hasFullscreen()?t.expandIcon.elm.addEventListener("click",this.onClickExpand.bind(this)):t.expandIcon.elm.classList.add(this.elements.style.hidden)}setNativeUI(){return ge.createNativeUI(this.parent.container,this.parent.opaVideoData,{btnText:this.parent.opaVideoData.ctaButton,btnUrl:this.parent.opaVideoData.ctaUrl,title:this.parent.opaVideoData.title,description:this.parent.opaVideoData.description,sponsored:this.parent.opaVideoData.sponsored,logoUrl:this.parent.opaVideoData.sponsorLogo&&this.parent.opaVideoData.sponsorLogo.logoUrl?this.parent.opaVideoData.sponsorLogo.logoUrl:null},{inVideoAssets:this.parent.options.inVideoAssets})}setFooterUI(){const e=this.parent.container,t=this.elements.footer;this.setPlayUI(),this.setSeekUI(),this.setTimeBoxUI(),this.setVolumeUI(),t.elm=document.createElement("div"),t.elm.id=t.id,t.elm.setAttribute("tabindex","101"),t.elm.appendChild(t.play.elm),t.elm.appendChild(t.seek.elm),t.elm.appendChild(t.timeBox.elm),t.elm.appendChild(t.volume.elm),t.elm.appendChild(t.expand.elm),e.appendChild(t.elm)}setPlayUI(){const t=e.getElement("play",this.elements),i=document.createElement("div"),s=document.createElement("i"),n=this.parent.options;i.classList.add(t.className),i.classList.add(this.elements.style.commonIconClassName),s.classList.add(t.playIcon.className),s.classList.add(this.elements.style.icons),!1!==n.showPlay&&!1!==n.showControls||i.classList.add(this.elements.style.invisible),s.appendChild(document.createTextNode(t.playIcon.playIconClassName)),i.appendChild(s),t.elm=i,t.playIcon.elm=s,t.playIcon.elm.addEventListener("click",this.onClickPlay.bind(this)),window.addEventListener("keydown",this.onPress)}setSeekUI(){const t=e.getElement("seek",this.elements),i=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),o=document.createElement("i"),l=this.parent.options;i.classList.add(t.className),s.classList.add(t.bar.className),n.classList.add(t.bar.loadBar.className),r.classList.add(t.bar.progressBar.className),o.classList.add(t.bar.handler.className),o.classList.add(this.elements.style.icons),a.classList.add(t.bar.time.className),a.classList.add(this.elements.style.hidden),!1!==l.showSeekBar&&!1!==l.showControls||i.classList.add(this.elements.style.invisible),o.appendChild(document.createTextNode(t.bar.handler.iconClassName)),s.appendChild(n),s.appendChild(r),s.appendChild(o),s.appendChild(a),i.appendChild(s),t.elm=i,t.bar.elm=s,t.bar.loadBar.elm=n,t.bar.progressBar.elm=r,t.bar.handler.elm=o,t.bar.time.elm=a,this.parent.mobile||(this.parent.seek&&s.addEventListener("click",this.onClickSeekBar.bind(this)),t.elm.addEventListener("mousemove",this.onMouseSeekBar.bind(this)),t.elm.addEventListener("mouseleave",this.onMouseSeekBar.bind(this)))}updateSeek(){const t=e.getElement("bar",this.elements);t&&!this.parent.mobile&&t.elm.addEventListener("click",this.onClickSeekBar.bind(this))}setTimeBoxUI(){const t=e.getElement("timeBox",this.elements),i=document.createElement("div"),s=document.createElement("div"),n=this.parent.options;i.classList.add(t.className),s.classList.add(t.timeBoxDisplay.className),s.appendChild(document.createTextNode(t.timeBoxDisplay.className)),i.appendChild(s),!1!==n.showTimeBox&&!1!==n.showControls||i.classList.add(this.elements.style.invisible),t.elm=i,t.timeBoxDisplay.elm=s,t.timeBoxDisplay.elm.innerHTML=""}setVolumeUI(){const t=e.getElement("volume",this.elements),i=t.volumeWrapper,s=document.createElement("div"),n=document.createElement("i"),r=document.createElement("div"),a=document.createElement("div"),o=document.createElement("div"),l=document.createElement("div"),d=this.parent.options;s.classList.add(t.className),s.classList.add(this.elements.style.commonIconClassName),n.classList.add(t.volumeIcon.className),r.classList.add(i.className),a.classList.add(i.volumeBar.className),o.classList.add(i.volumeSeekBar.className),l.classList.add(i.volumeHandler.className),n.classList.add(t.volumeIcon.highClassName),n.classList.add(this.elements.style.icons),!1!==d.showVolume&&!1!==d.showControls||s.classList.add(this.elements.style.invisible),n.appendChild(document.createTextNode(t.volumeIcon.highIconClassName)),r.appendChild(a),r.appendChild(o),r.appendChild(l),s.appendChild(n),s.appendChild(r),t.elm=s,t.volumeIcon.elm=n,i.elm=r,i.volumeBar.elm=a,i.volumeSeekBar.elm=o,i.volumeHandler.elm=l,t.volumeIcon.elm.addEventListener("click",this.onClickVolume.bind(this)),this.parent.mobile||(t.volumeIcon.elm.addEventListener("mouseenter",this.onEnterVolumeSeek.bind(this)),t.volumeIcon.elm.addEventListener("mouseleave",this.onLeaveVolumeSeek.bind(this)),i.elm.addEventListener("click",this.onClickVolumeSeek.bind(this)),i.elm.addEventListener("mouseenter",this.onEnterVolumeSeek.bind(this)),i.elm.addEventListener("mouseleave",this.onLeaveVolumeSeek.bind(this)))}setUIFonts(e){const t=document.getElementsByClassName(this.elements.style.commonIconClassName),i=e||this.parent.container.offsetWidth,s=t.length;let n=s;for(;n--;)t[n].classList.remove(this.elements.style.smallIconClassName),t[n].classList.remove(this.elements.style.mediumIconClassName);if(this.elements.footer.seek.elm.classList.remove(this.elements.style.smallSeekClassName),this.elements.footer.seek.elm.classList.remove(this.elements.style.mediumSeekClassName),this.elements.header.dummy.elm.classList.remove(this.elements.style.smallSeekClassName),this.elements.header.dummy.elm.classList.remove(this.elements.style.mediumSeekClassName),i<500){let e=s;for(;e--;)t[e].classList.add(this.elements.style.smallIconClassName);this.elements&&this.elements.footer&&this.elements.footer.seek&&this.elements.footer.seek.elm&&this.elements.footer.seek.elm.classList.add(this.elements.style.smallSeekClassName),this.elements&&this.elements.header&&this.elements.header.dummy&&this.elements.header.dummy.elm&&this.elements.header.dummy.elm.classList.add(this.elements.style.smallSeekClassName)}else if(i<700){let e=s;for(;e--;)t[e].classList.add(this.elements.style.mediumIconClassName);this.elements&&this.elements.footer&&this.elements.footer.seek&&this.elements.footer.seek.elm&&this.elements.footer.seek.elm.classList.add(this.elements.style.mediumSeekClassName),this.elements&&this.elements.header&&this.elements.header.dummy&&this.elements.header.dummy.elm&&this.elements.header.dummy.elm.classList.add(this.elements.style.mediumSeekClassName)}}setUICustomControls(){if(this.parent.options.customControls)try{const e=JSON.parse(this.parent.options.customControls);e.adIcon&&this.setAdIconUI(e),e.playerBackgroundColor&&this.setBackgroundColor(e)}catch(e){console.log("JsonParse error - "+e)}}setCustomPlaybackButtonsUI(t){const i=e.getElement("footer",this.elements).play.playIcon.elm;try{const e=JSON.parse(this.parent.options.customControls);i.style.backgroundImage=`url(${e.playbackButtons.play})`,i.style.backgroundSize="contain",i.style.backgroundRepeat="no-repeat",i.style.backgroundPosition="center",i.style.color="transparent"}catch(e){console.log("JsonParse error - "+e)}}setCustomSoundButtonsUI(e){}setBackgroundColor(e){const t=document.getElementById("mp");t&&e.playerBackgroundColor&&(t.style.background=e.playerBackgroundColor,t.style.boxShadow="unset");const i=document.getElementById(this.parent.options.containerId+"_omp");i&&e.playerBackgroundColor&&(i.style.background=e.playerBackgroundColor,i.style.boxShadow="unset")}setAdIconUI(t){const i=this.parent.container,s=this,n=e.getElement("adIcon",this.elements);if(n.elm=document.createElement("div"),t&&t.adIcon&&t.adIcon.link){const e=new Image;e.onload=function(){if(s.customControls.adIcon.src=this.src,s.customControls.adIcon.width=this.width,s.customControls.adIcon.height=this.height,n.elm.style.height=t.adIcon.height,n.elm.style.width=t.adIcon.width,n.elm.style.fontSize=t.adIcon.fontSize,n.elm.style.lineHeight=n.elm.style.height,n.elm.style.color=t.adIcon.color,n.elm.innerHTML=t.adIcon.text?t.adIcon.text:"",n.elm.style.fontFamily=t.adIcon.font,n.elm.style.backgroundImage="url("+this.src+")",t.adIcon.clickthrough){n.elm.style.cursor="pointer";const e=t.adIcon.clickthrough;n.elm.addEventListener("click",(t=>{t.preventDefault(),s.pause(),window.open(e,"_blank")}))}n.elm.classList.add(n.className)},e.src=t.adIcon.link}i.appendChild(n.elm)}showVolumeSeekBar(){e.getElement("volumeWrapper",this.elements).elm.classList.add(this.elements.style.active)}hideVolumeSeekBar(){e.getElement("volumeWrapper",this.elements).elm.classList.remove(this.elements.style.active)}startProgress(){this.progressInterval=setInterval((()=>{if(this.interpreter.playing){const t=e.getElement("bar",this.elements),i=e.getElement("timeBox",this.elements),s=this.interpreter.getAdCurrentTime(),n=this.interpreter.getAdDuration(),r=i.timeBoxDisplay.elm;let a=100*s/n;a>100&&(a=100),t.progressBar.elm.style.width=a+"%",t.handler.elm.style.left=t.progressBar.elm.offsetWidth+"px",r.innerHTML="",r.appendChild(document.createTextNode(e.humanTime(n-s)))}}),1e3)}startViewabilityInterval(){const e=Math.random();this.viewabiltyEventInterval[e]=window.setInterval((()=>{const t=this.getCurrentViewability();!this.getAdPaused()&&t&&t>=this.viewabilityPercentageThreshold?this.totalContinuosViewTime+=this.viewabiltyIntervalTime:this.totalContinuosViewTime=0,this.totalContinuosViewTime>=this.viewabiltyEventTime&&(window.clearInterval(this.viewabiltyEventInterval[e]),this.onVideoInView())}),this.viewabiltyIntervalTime)}getCurrentViewability(){const e=document.getElementById(this.parent.id);if(!e)return 0;let t=e.getBoundingClientRect(),i=this.getViewportSizeGlobal().height,s=e.clientHeight;if(!s)return 0;const n=t.top,r=t.top+s;let a=0;if(n>0){if(n>i)return 0;if(r<i)return 100;a=i-n}else{if(r<0)return 0;a=r>i?i:r}return Math.round(100*a/s)}getViewportSizeGlobal(){let e,t,i,s={height:0,width:0};return e=void 0!==window.innerWidth,t=void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!==document.documentElement.clientWidth,i=!1===e&&!1===t,e?(s.height=window.innerHeight,s.width=window.innerWidth):t?(s.height=document.documentElement.clientHeight,s.width=document.documentElement.clientWidth):i&&(s.height=document.getElementsByTagName("body")[0].clientHeight,s.width=document.getElementsByTagName("body")[0].clientWidth),s}onVideoInView(){this.videoWasViewed=!0;const e=this.interpreter.media.viewableImpressions;e&&e.viewable&&this.interpreter.trackingEvents(e.viewable);const t=new CustomEvent("playerInView",{bubbles:!1,cancelable:!0});this.parent.container.dispatchEvent(t)}onAdReady(e){e&&this.onError(e);let t=this.checkForVpaid()||this.parser.medias[0];this.framework=t.apiFramework||"VAST";const i="VPAID"===this.framework.toUpperCase()&&/imasdk/.test(t.fileURL)&&this.parser.medias.length>1;i&&(t=this.parser.medias[1]),this.duration=t.duration,this.interpreter="VPAID"!==t.apiFramework||i?new pe(this.parent,this.parser,this.elements.videoContainer):new ne(t,this.parent,this.elements.videoContainer),this.setLoaderUI(),!0===this.interpreter.streaming&&(this.parent.options.twoStepsLoad=!1),!0!==this.parent.options.twoStepsLoad||"VPAID"===this.framework.toUpperCase()||this.ctwAdDataAutoPlayEnabled?(this.setUI(),this.interpreter.init().catch(this.onError.bind(this))):(this.setUI(),this.onPlayerReady())}checkForVpaid(){if(this.parser.medias.length<=1)return;let e=this.parser.medias,t=[],i=[];const s=e=>{const s=(e.width/e.height).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0],n=`${e.width}*${e.height}`;t.hasOwnProperty(s)||(t[s]={}),t[s].hasOwnProperty(n)||(t[s][n]=[]),i.indexOf(n)<0&&i.push(n),t[s][n].push(e)};let n=0,r=e.length;for(;n<r;n++){"VPAID"===e[n].apiFramework&&s(e[n]);const t=e[n].mimeType,i=e[n].fileURL.split(".").pop();t?"video/mp4"!==t&&"video/quicktime"!==t||s(e[n]):"mp4"!==i.toLowerCase()&&"mov"!==i.toLowerCase()||s(e[n])}if(i.sort(((e,t)=>{const i=e.split("*"),s=t.split("*"),n=parseInt(i[0]),r=parseInt(i[1]),a=parseInt(s[0]),o=parseInt(s[1]);return n<a||r<o?1:n>a||r>o?-1:0})),t&&Object.keys(t).length&&i.length){const e=i[0];var a;for(let i=0;i<Object.keys(t).length;i++){let s=t[Object.keys(t)[i]];s.hasOwnProperty(e)&&(a=s)}let s=0,n=a[e].length;for(;s<n;s++)if("VPAID"===a[e][s].apiFramework)return a[e][s];return a[e][0]}}setLoaderUI(){const t=this.parent.container,i=e.getElement("loader",this.elements),s=e.getElement("style",this.elements),n=document.createElement("div");n.classList.add(s.hidden),n.classList.add(i.className),i.elm=n,t.appendChild(i.elm)}showLoader(){const t=e.getElement("loader",this.elements),i=e.getElement("style",this.elements);t.elm.classList.remove(i.hidden)}hideLoader(){const t=e.getElement("loader",this.elements),i=e.getElement("style",this.elements);t.elm.classList.add(i.hidden)}onKeyPress(e){if(this.isChild(this.elements.videoContainer.elm,document.activeElement)&&(e.preventDefault(),this.interpreter.started)){32===(e||window.event).keyCode&&this.onClickPlay(e)}}onPlayerReady(){const e=new CustomEvent("playerReady",{bubbles:!1,cancelable:!0});this.parent.container.dispatchEvent(e)}onControlClick(e){this.onMouseEnter(e),setTimeout((()=>{this.onMouseLeave(e)}),1e3)}setFocus(){this.elements.videoContainer.elm.focus()}onMouseEnter(e){e&&e.preventDefault(),this.uiTimeout&&clearTimeout(this.uiTimeout);const t=this.elements.header,i=this.elements.footer;this.elements.inVideoNativeAssets.elm&&this.elements.inVideoNativeAssets.elm.classList.add(this.elements.style.active),t.elm.classList.add(this.elements.style.active),i.elm.classList.add(this.elements.style.active)}onMouseLeave(e){e&&e.preventDefault(),this.uiTimeout&&clearTimeout(this.uiTimeout),this.uiTimeout=setTimeout((()=>{const e=this.elements.header,t=this.elements.footer;this.elements.inVideoNativeAssets.elm&&this.elements.inVideoNativeAssets.elm.classList.remove(this.elements.style.active),e.elm.classList.remove(this.elements.style.active),t.elm.classList.remove(this.elements.style.active),this.hideVolumeSeekBar()}),this.parent.options.controlsDelay)}onClickClose(e){e.preventDefault(),e.stopPropagation(),this.destroy();const t=new CustomEvent("aduserclose",{bubbles:!1,cancelable:!0});this.parent.container.dispatchEvent(t)}onClickPlay(e){e.preventDefault(),e.stopPropagation(),this.interpreter.playing?this.pause():this.interpreter.started?this.resume():this.interpreterReady?this.play():this.interpreter.initializing||(this.showLoader(),this.interpreter.init())}onClickExpand(t){t.preventDefault();const i=e.getElement("expandIcon",this.elements);i.elm.classList.contains(i.collapseClassName)?this.interpreter.fullscreen():this.interpreter.collapse()}onClickSeekBar(t){t.preventDefault();const i=e.getElement("bar",this.elements),s=i.elm.offsetWidth,n=parseInt(100*t.offsetX/s),r=n*this.interpreter.getAdDuration()/100;i.progressBar.elm.style.width=n+"%",i.handler.elm.style.left=i.progressBar.elm.offsetWidth+"px",this.interpreter.seek(r);const a=new CustomEvent("userseek",{detail:r,bubbles:!1,cancelable:!0});this.parent.container.dispatchEvent(a)}onMouseSeekBar(t){const i=this.elements.footer.seek,s=i.bar.time;if(!t.target.classList.contains(s.className)){const n=i.elm,r=s.elm;if(this.timeInfoTimeout&&clearTimeout(this.timeInfoTimeout),"mousemove"===t.type){const i=this.getAdDuration(),s=n.offsetWidth,a=parseInt(t.offsetX*i/s);r.innerHTML="",r.appendChild(document.createTextNode(e.humanTime(a))),r.classList.remove(this.elements.style.hidden),r.style.left=t.offsetX-20+"px"}else this.timeInfoTimeout=setTimeout((()=>{r.classList.add(this.elements.style.hidden)}),1e3)}}onClickVolume(t){t.preventDefault();e.getElement("volumeIcon",this.elements);this.parent.mobile&&this.hideVolumeSeekBar(),this.volumeState>0?this.setMute(!0):(0===this.lastPlayedVolume&&(this.lastPlayedVolume=1),this.setMute(!1))}onClickVolumeSeek(t){t.preventDefault();const i=e.getElement("volumeWrapper",this.elements),s=i.elm.offsetHeight,n=parseInt(100*(s-t.offsetY)/s);i.volumeSeekBar.elm.style.height=n+"%",i.volumeHandler.elm.style.bottom=i.volumeSeekBar.elm.offsetHeight+"px";const r=n/100;this.lastPlayedVolume=this.volumeState=r,this.interpreter.volume(r)}onEnterVolumeSeek(){this.volumeTimer&&clearTimeout(this.volumeTimer),this.showVolumeSeekBar()}onLeaveVolumeSeek(){this.volumeTimer=setTimeout((()=>{this.hideVolumeSeekBar()}),2e3)}onReady(){this.interpreterReady=!0,this.parent.options.muted&&this.setMute(!0),this.parent.options.autoplay&&setTimeout((()=>{this.play()}),100)}onProgress(t,i){const s=this.interpreter.getAdDuration(),n=e.getElement("loadBar",this.elements);let r=100*i.end/s;r>100&&(r=100),n.elm.style.width=r+"%"}onPlay(){const t=e.getElement("playIcon",this.elements);t.elm.innerHTML="",t.elm.appendChild(document.createTextNode(t.pauseIconClassName)),this.startProgress(),this.startViewabilityInterval(),this.parent.mobile&&this.onControlClick()}onStop(){const t=e.getElement("playIcon",this.elements);t.elm.innerHTML="",t.elm.appendChild(document.createTextNode(t.playIconClassName)),clearInterval(this.progressInterval)}onComplete(){const t=e.getElement("bar",this.elements),i=e.getElement("playIcon",this.elements);i.elm.innerHTML="",i.elm.appendChild(document.createTextNode(i.playIconClassName)),t.progressBar.elm.style.width="100%",this.videoCompleted=!0,2===this.parent.options.vidgetVersion&&this.destroy(),setTimeout((()=>{this.parent.searchForVideoAds()}),this.parent.opaCallRestDuration)}onPause(){const t=e.getElement("playIcon",this.elements);t.elm.innerHTML="",t.elm.appendChild(document.createTextNode(t.playIconClassName))}onResume(){const t=e.getElement("playIcon",this.elements);t.elm.innerHTML="",t.elm.appendChild(document.createTextNode(t.pauseIconClassName))}onVolume(t){const i=e.getElement("volumeIcon",this.elements);if("mute"===t)i.elm.classList.remove(i.highClassName),i.elm.classList.remove(i.lowClassName),i.elm.classList.add(i.muteClassName),i.elm.innerHTML="",i.elm.appendChild(document.createTextNode(i.muteIconClassName));else{const e=this.interpreter.getVolume(),t=e<.5?i.lowClassName:i.highClassName,s=e<.5?i.lowIconClassName:i.highIconClassName;this.interpreter.unmute(!1,!1),i.elm.classList.remove(i.muteClassName),i.elm.classList.add(t),i.elm.innerHTML="",i.elm.appendChild(document.createTextNode(s))}}onFullscreen(t){const i=e.getElement("expandIcon",this.elements);i.elm.innerHTML="";const s=this.elements.header,n=this.elements.footer;"enterfullscreen"===t?(i.elm.appendChild(document.createTextNode(i.collapseIconClassName)),i.elm.classList.remove(i.collapseClassName),i.elm.classList.add(i.expandClassName),this.parent.mobile&&(s.elm.classList.remove(this.elements.style.active),n.elm.classList.remove(this.elements.style.active))):(i.elm.appendChild(document.createTextNode(i.expandIconClassName)),i.elm.classList.add(i.collapseClassName),i.elm.classList.remove(i.expandClassName),this.parent.mobile&&(s.elm.classList.add(this.elements.style.active),n.elm.classList.add(this.elements.style.active))),setTimeout((()=>{this.parent.resize()}),100)}onFullscreenError(e){console.error(e)}onClickToPlay(){const t=this.elements.thumbnailWrapper,i=e.getElement("style",this.elements);t.elm.classList.add(i.hidden),this.clickToPlay()}onError(e){e&&this.parent.onError(e)}isChild(e,t){let i=t.parentNode;for(;null!=i;){if(i==e)return!0;i=i.parentNode}return!1}calculateBitRate(){const e=this.elements.videoContainer.video.elm;if(e&&void 0!==e.webkitVideoDecodedByteCount){let t=0,i=0,s=0,n=0;this.bitrateInterval=setInterval((()=>{if(this.interpreter.playing){const r=Math.round(e.webkitVideoDecodedByteCount/1e6/(e.currentTime/60*.0075));t=e.webkitVideoDecodedByteCount,i>0&&(n+=r,s=n/i,this.interpreter.media.bitrate=s),i++,10===i&&clearInterval(this.bitrateInterval)}}),1e3)}}play(){this.interpreter.started||(this.parent.options.twoStepsLoad&&"VPAID"!==this.framework.toUpperCase()&&!this.ctwAdDataAutoPlayEnabled?(this.showLoader(),this.interpreter.init().then(this.hideLoader.bind(this)).then(this.parent.resize.bind(this.parent)).then(this.interpreterPlay()).catch(this.onError.bind(this))):this.interpreterPlay()),this.calculateBitRate()}interpreterPlay(){this.interpreter&&(this.hideLoader(),this.interpreter.play(),setTimeout((()=>{this.parent.resize()}),300))}clickToPlay(){this.interpreter&&this.interpreter.clickToPlay()}pause(){this.interpreter&&this.interpreter.pause()}resume(){this.interpreter&&this.interpreter.resume()}stop(){this.interpreter&&this.interpreter.stop()}isMuted(){return this.interpreter?this.interpreter.isMuted():null}getVolume(){return this.interpreter?this.interpreter.getVolume():null}resize(e,t){this.interpreter&&this.interpreter.resize(e,t),this.setUIFonts(e)}setMute(e){if(this.interpreter){let t;e?(this.interpreter.mute(),this.volumeState=0,t="mute"):(this.interpreter.unmute(),this.volumeState=this.lastPlayedVolume||1,t="unmute");const i=new CustomEvent(t,{bubbles:!1,cancelable:!0});this.parent.container.dispatchEvent(i)}}setVideoMute(e){this.interpreter&&(e?this.interpreter.mute(!1):this.interpreter.unmute(!1))}setControls(e){const t=this.elements.header,i=this.elements.footer;this.uiTimeout&&clearTimeout(this.uiTimeout),e?(t.elm.classList.add(this.elements.style.active),i.elm.classList.add(this.elements.style.active),this.uiTimeout=setTimeout((()=>{this.parent.mobile||(t.elm.classList.remove(this.elements.style.active),i.elm.classList.remove(this.elements.style.active))}),this.parent.options.controlsDelay)):(t.elm.classList.remove(this.elements.style.active),i.elm.classList.remove(this.elements.style.active))}destroy(){if(this.videoCompleted||this.stop(),this.interpreter&&this.interpreter.videoStartedPlaying){const e=this.interpreter.media.viewableImpressions;!1===this.videoWasViewed&&e&&e.notViewable?this.interpreter.trackingEvents(e.notViewable):void 0===this.videoWasViewed&&e&&e.viewUndetermined&&this.interpreter.trackingEvents(e.viewUndetermined),this.interpreter.destroy()}this.progressInterval&&clearInterval(this.progressInterval),this.bitrateInterval&&clearInterval(this.bitrateInterval),window.removeEventListener("keypress",this.onPress),window.removeEventListener("keydown",this.onPress),this.parent.elements.container.elm.innerHTML=""}getAdPaused(){return this.interpreter?this.interpreter.getAdPaused():null}getAdErrorCode(){return this.interpreter?this.interpreter.getAdErrorCode():null}getAdErrorMessage(){return this.interpreter?this.interpreter.getAdErrorMessage():null}getAdSystem(){return this.interpreter?this.interpreter.getAdSystem():null}getVideoBitrate(){return this.interpreter?this.interpreter.getVideoBitrate():null}getAdMediaBitrateArray(){return this.interpreter?this.interpreter.getAdMediaBitrateArray():null}getHeavyAdStatus(){return this.interpreter?this.interpreter.getHeavyAdStatus():null}getAdMediaHeight(){return this.interpreter?this.interpreter.getAdMediaHeight():null}getAdMediaWidth(){return this.interpreter?this.interpreter.getAdMediaWidth():null}getAdMediaUrl(){return this.interpreter?this.interpreter.getAdMediaUrl():null}getAdTagUrl(){return this.interpreter?this.interpreter.getAdTagUrl():null}getAdDuration(){return this.interpreter?this.interpreter.getAdDuration():null}getAdCurrentTime(){return this.interpreter?this.interpreter.getAdCurrentTime():null}getAdDeliveryType(){return this.interpreter?this.interpreter.getAdDeliveryType():null}getVastWidth(){return this.interpreter?this.interpreter.getVastWidth():null}getVastHeight(){return this.interpreter?this.interpreter.getVastHeight():null}getVideoClickThroughURL(){return this.interpreter?this.interpreter.getVideoClickThroughURL():null}getVideoClickTrackingURL(){return this.interpreter?this.interpreter.getVideoClickTrackingURL():null}getCompanionAds(){return this.interpreter?this.interpreter.getCompanionAds():null}seek(e){e>=0&&e<=this.interpreter.getAdDuration()&&this.interpreter.seek(e)}getVolumeState(){return this.volumeState}notifyVideoHasBeenRendered(e){return this.interpreter?this.interpreter.notifyVideoHasBeenRendered(e):null}};const ye=1,be=2,Ee=1,Te=4;class we{constructor(e){this.opaRequestParams=e,this.opaVidoeData=null}initOpaVideoCall(e){return new Promise(((t,i)=>{e.firstAuctionVideo?this.getRtbDataFromResponse(e,(e=>{this.opaVidoeData.isFirstAuctionVideo=!0,t(e)}),(e=>{i(e)}),e.firstAuctionVideo):this.callODB(this.opaRequestParams,e,(e=>{t(e)}),(e=>{i(e)}))}))}callODB(e,t,i,s){try{window.OBR.extern.callRecs(e,this.getRtbDataFromResponse.bind(this,t,i,s))}catch(e){s(e)}}getRtbDataFromResponse(e,t,i,s){const n=s.doc;if(n&&n[0]){const s=n[0],r=s.video;if(r){this.opaVidoeData={vastXML:r.vastxml,pageCategories:r.page_category,userCategories:r.user_interest_category,advId:s.advId,advName:s.adv_name,campaignId:s.pc_cmp_id,title:r.title,trackers:this.extractEventTrackers(s.eventTrackers),description:s.desc,sponsored:s.source_display_name?s.source_display_name:"",opaPartnerId:s.partner_id,opaAdId:s.pc_id,agencyId:s.agency_id,width:s.display?s.display.width:0,height:s.display?s.display.height:0,onViewed:s["on-viewed"],productId:s.product_id?s.product_id:null,isNativeVideo:"true"===s.is_native_video,ctaButton:s.cta,ctaUrl:r.url,sponsorLogo:{width:"belowVideo"===e.nativeLogoPosition?20:60,height:"belowVideo"===e.nativeLogoPosition?20:60,logoUrl:s.logo?s.logo.url:null}};return void(this.validateAd(e)?i():t(this.opaVidoeData))}}i()}validateAd(e){return this.opaVidoeData.isNativeVideo&&"never"===e.nativeVideoMode?"video is native but nativeVideoMode is set to never":null}extractEventTrackers(e){const t={pixels:{impressions:[],videoViewable:[]},jsTrackers:{impressions:[],videoViewable:[]}};return null==e||e.forEach((e=>{e.method===ye?(e.event===Ee&&t.pixels.impressions.push(e.url),e.event===Te&&t.pixels.videoViewable.push(e.url)):e.method===be&&(e.event===Ee&&t.jsTrackers.impressions.push(e.url),e.event===Te&&t.jsTrackers.videoViewable.push(e.url))})),t}getOpaVideoData(){return this.opaVidoeData}}!function(){if("function"==typeof window.CustomEvent)return!1;window.CustomEvent=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}}();var Ie=class{constructor(e){if(this.id=e,this.env="prod",this.mobile=!1,this.vastXML=null,this.pixels=null,this.jsTrackers=null,this.container=null,this.video=null,this.seek=!1,this.shouldTrackMoat=!1,this.options=null,this.adBlocker=!1,this.resizeId=0,this.maxRetries=3,this.opaVideoData=null,this.opaCallRestDuration=5,this.wasm={active:!1,url:"https://localhost:8084/outbrain-media-player/wasm/vast.js"},this.elements={container:{elm:null,className:"omp-full"},parser:{id:"omp-parser"},interpreter:{id:"omp-vast"}},this.events={resize:this.onResize.bind(this)},!this.id)return this.onError(new Error("Invalid ID attribute provided"))}init(e){if(console.debug("OMP init: "+Date.now()),this.env=e.env?e.env:"prod",this.options=e,2!==e.vidgetVersion||!e.requestParams)return this.initVideoAd(e);this.maxRetries=e.maxRetries||3,this.opaCallRestDuration=1e3*(e.opaCallRestDuration||this.opaCallRestDuration),this.searchForVideoAds(e)}initVideoAd(t){return new Promise((i=>{e.waterfall([this.setPlayerContainer],this).catch(this.onError.bind(this)).then((()=>{if(!t.hasOwnProperty("vastXML"))throw new Error("Invalid vast xml source");this.mobile=t.hasOwnProperty("mobile")?t.mobile:this.isMobile(),this.container.classList.add(this.mobile?"omp-mobile":"omp-desktop"),this.vastXML=t.vastXML,this.seek=t.seek||!1,this.pixels=t.pixels?t.pixels:[],this.jsTrackers=t.jsTrackers?t.jsTrackers:[],this.shouldTrackMoat=t.trackMoat||!1,this.setDefaultOpts(),this.setCustomOpts(),this.options.hasOwnProperty("promisedInit")&&this.options.promisedInit&&this.elements.container.elm.addEventListener("ready",(()=>{i("ready-promise")}));document.getElementById(this.elements.parser.id)?this.video=new fe(this):e.waterfall([this.insertWasm,this.detectAdBlocker,this.insertVideoTag],this).catch(this.onError.bind(this)),window.addEventListener("resize",this.events.resize),this.options.promisedInit||i(!0)}))}))}searchForVideoAds(){if(2!==this.options.vidgetVersion)return;if(0===this.maxRetries)return void this.onAdLookupExhausted();this.maxRetries--;const e=this.options.isPreload||this.options.isInView()?"&videoPlaybackMethod=inView":"&videoPlaybackMethod=autoPlay";/&videoPlaybackMethod=/gi.test(this.options.requestParams.extraParams)?this.options.requestParams.extraParams=this.options.requestParams.extraParams.replace(/(&videoPlaybackMethod=autoPlay|&videoPlaybackMethod=inView)/,e):this.options.requestParams.extraParams+=this.options.isPreload||this.options.isInView()?"&videoPlaybackMethod=inView":"&videoPlaybackMethod=autoPlay";const t=new we(this.options.requestParams);t.initOpaVideoCall(this.options).then((e=>{this.options.firstAuctionVideo=null,e&&(this.options.vastXML=e.vastXML,this.opaVideoData=t.getOpaVideoData(),this.initVideoAd(this.options))})).catch((e=>{this.options.firstAuctionVideo=null,setTimeout((()=>{this.searchForVideoAds(this.options)}),this.opaCallRestDuration)}))}updateMacros(e){try{this.video.interpreter.updateMacros(e)}catch(e){}}setPlayerContainer(){if(this.container=this.options.playerElement||document.getElementById(this.id),this.elements.container.elm=this.container,this.container){const e=document.getElementsByTagName("head")[0];if(!document.getElementById("omp-style")){const t=document.createElement("link");t.href=a[this.env].style,t.id="omp-style",t.rel="stylesheet",t.type="text/css",e.appendChild(t)}this.container.classList.add("omp")}else this.onError(new Error(`Cannot retrieve DOM element with ID ${this.id}`))}isMobile(){return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))}setDefaultOpts(){this.options.hasOwnProperty("controlsDelay")||(this.options.controlsDelay=3e3),this.options.hasOwnProperty("twoStepsLoad")||(this.options.twoStepsLoad=!1),this.options.autoplay&&(this.options.twoStepsLoad=!1)}setCustomOpts(){this.options.relativeSize&&this.container.classList.add(this.elements.container.className)}insertWasm(){return new Promise(((e,t)=>{if(this.wasm.active){document.getElementsByTagName("head")[0];document.createElement("script").src=this.wasm.url}else e(!0)}))}detectAdBlocker(){return new Promise((e=>{if(this.options.adBlockerDetection&&!document.getElementById("obad")){const t=document.getElementsByTagName("body")[0],i=document.createElement("script");i.id="obad",i.src=a[this.env].adBlockerDetection;const s=setTimeout((()=>{const t=document.getElementById("iSsVFRmjlhBx");t?t.parentNode.removeChild(t):(this.adBlocker=!0,console.log("Adblocker detected")),e(!0)}),6e3);i.onload=()=>{clearTimeout(s),this.adBlocker=!1;const t=document.getElementById("iSsVFRmjlhBx");t&&t.parentNode.removeChild(t),e(!0)},t.appendChild(i)}else e(!0)}))}insertVideoTag(){this.adBlocker||(this.video=new fe(this))}onResize(e){this.resizeId&&clearTimeout(this.resizeId),this.resizeId=setTimeout((()=>{this.resize()}),200)}play(){this.video.play()}pause(){this.video.pause()}resume(){this.video.resume()}stop(){this.video.stop()}skipAd(){this.video.destroy();const e=new CustomEvent("adskipped",{bubbles:!1,cancelable:!0});this.container.dispatchEvent(e),this.searchForVideoAds()}stopAds(){this.video.stop()}displayThumbnail(){this.video.displayThumbnail()}resize(e,t){e&&t?this.video.resize(e,t):this.video.resize(this.container.offsetWidth,this.container.offsetHeight)}setMute(e){this.video.setMute(e)}setVideoMute(e){this.video.setVideoMute(e)}setControls(e){this.video.setControls(e)}destroy(){this.video&&this.video.destroy()}mute(){this.video.setMute(!0)}unmute(){this.video.setMute(!1)}isMuted(){return this.video.isMuted()}getVolume(){return this.video.getVolume()}getAdPaused(){return this.video.getAdPaused()}getAdErrorCode(){return this.video.getAdErrorCode()}getAdErrorMessage(){return this.video.getAdErrorMessage()}getAdSystem(){return this.video.getAdSystem()}getVideoBitrate(){return this.video.getVideoBitrate()}getAdMediaBitrateArray(){return this.video.getAdMediaBitrateArray()}getHeavyAdStatus(){return this.video.getHeavyAdStatus()}getAdMediaHeight(){return this.video.getAdMediaHeight()}getAdMediaWidth(){return this.video.getAdMediaWidth()}getAdMediaUrl(){return this.video.getAdMediaUrl()}getAdTagUrl(){return this.video.getAdTagUrl()}getAdDuration(){return 1e3*this.video.getAdDuration()}getAdCurrentTime(){return 1e3*this.video.getAdCurrentTime()}getDuration(){return 1e3*this.video.duration}getAdUnit(){return this.video.interpreter.adUnit}getAdMedias(){return this.video.parser.medias}getAdDeliveryType(){return this.video.getAdDeliveryType()}getVastWidth(){return this.video.getVastWidth()}getVastHeight(){return this.video.getVastHeight()}getVideoClickThroughURL(){return this.video.getVideoClickThroughURL()}getVideoClickTrackingURL(){return this.video.getVideoClickTrackingURL()}getCompanionAds(){return this.video.getCompanionAds()}onSeek(e){this.video.seek(e)}updateSeek(){this.video.updateSeek()}getVolumeState(){return this.video.getVolumeState()}onError(e){const t=new CustomEvent("playererror",{detail:e,bubbles:!1,cancelable:!0});this.container.dispatchEvent(t)}onAdLookupExhausted(){const e=new CustomEvent("adLookupExhausted",{bubbles:!1,cancelable:!0});(this.container||this.options.playerElement).dispatchEvent(e)}notifyVideoHasBeenRendered(e){this.video.notifyVideoHasBeenRendered(e)}getOpaVideoData(){return this.opaVideoData}};window.OutbrainMP=Ie}()}();